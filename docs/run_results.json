{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.3", "generated_at": "2023-12-12T20:25:31.107933Z", "invocation_id": "2dccfe2b-eed0-4192-9414-6f0641c72fb7", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.886908Z", "completed_at": "2023-12-12T20:25:29.914852Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.916844Z", "completed_at": "2023-12-12T20:25:29.916857Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03374004364013672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_account_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.906396Z", "completed_at": "2023-12-12T20:25:29.915291Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.917117Z", "completed_at": "2023-12-12T20:25:29.917120Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03330492973327637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_account_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.909262Z", "completed_at": "2023-12-12T20:25:29.915561Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.917592Z", "completed_at": "2023-12-12T20:25:29.917595Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.033431053161621094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_ad_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.912001Z", "completed_at": "2023-12-12T20:25:29.916333Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.918832Z", "completed_at": "2023-12-12T20:25:29.918834Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03424382209777832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_ad_group_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.923629Z", "completed_at": "2023-12-12T20:25:29.935337Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.936789Z", "completed_at": "2023-12-12T20:25:29.936795Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016882896423339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_ad_group_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.927194Z", "completed_at": "2023-12-12T20:25:29.935666Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.937303Z", "completed_at": "2023-12-12T20:25:29.937305Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017248153686523438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_ad_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.929908Z", "completed_at": "2023-12-12T20:25:29.936488Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.939030Z", "completed_at": "2023-12-12T20:25:29.939033Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018239974975585938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_campaign_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.932563Z", "completed_at": "2023-12-12T20:25:29.937051Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.939657Z", "completed_at": "2023-12-12T20:25:29.939660Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.018175840377807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_campaign_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.952979Z", "completed_at": "2023-12-12T20:25:29.953963Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.955821Z", "completed_at": "2023-12-12T20:25:29.955826Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011036872863769531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_account_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.943265Z", "completed_at": "2023-12-12T20:25:29.954263Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.956085Z", "completed_at": "2023-12-12T20:25:29.956089Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016887903213500977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_keyword_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__keyword_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.946446Z", "completed_at": "2023-12-12T20:25:29.954531Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.956388Z", "completed_at": "2023-12-12T20:25:29.956392Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016529083251953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_keyword_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__keyword_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.950319Z", "completed_at": "2023-12-12T20:25:29.955549Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.958335Z", "completed_at": "2023-12-12T20:25:29.958338Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01674795150756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__search_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_search_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__search_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.962423Z", "completed_at": "2023-12-12T20:25:29.963470Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.968958Z", "completed_at": "2023-12-12T20:25:29.968965Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010203838348388672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_account_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.963762Z", "completed_at": "2023-12-12T20:25:29.964668Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.969268Z", "completed_at": "2023-12-12T20:25:29.969271Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010300159454345703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_group_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.964940Z", "completed_at": "2023-12-12T20:25:29.965776Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.969526Z", "completed_at": "2023-12-12T20:25:29.969529Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010396003723144531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_group_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.966948Z", "completed_at": "2023-12-12T20:25:29.968625Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.971391Z", "completed_at": "2023-12-12T20:25:29.971394Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010458946228027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.975067Z", "completed_at": "2023-12-12T20:25:29.976192Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.980900Z", "completed_at": "2023-12-12T20:25:29.980904Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009487152099609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.976585Z", "completed_at": "2023-12-12T20:25:29.977500Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.981146Z", "completed_at": "2023-12-12T20:25:29.981148Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00960993766784668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.977786Z", "completed_at": "2023-12-12T20:25:29.978635Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.981435Z", "completed_at": "2023-12-12T20:25:29.981443Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009716033935546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_campaign_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.979775Z", "completed_at": "2023-12-12T20:25:29.980630Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:29.983532Z", "completed_at": "2023-12-12T20:25:29.983535Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009986162185668945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_keyword_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.987347Z", "completed_at": "2023-12-12T20:25:29.988522Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.036363Z", "completed_at": "2023-12-12T20:25:30.036370Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05264401435852051, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_keyword_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:29.988860Z", "completed_at": "2023-12-12T20:25:30.024641Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.036672Z", "completed_at": "2023-12-12T20:25:30.036675Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05284309387207031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_search_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.032328Z", "completed_at": "2023-12-12T20:25:30.327883Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.328461Z", "completed_at": "2023-12-12T20:25:30.328467Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.37592291831970215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    last_modified_time\n    \n as \n    \n    last_modified_time\n    \n, \n    \n    \n    time_zone\n    \n as \n    \n    time_zone\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as account_id,\n        name as account_name,\n        last_modified_time as modified_at,\n        time_zone,\n        currency_code,\n        row_number() over (partition by source_relation, id order by last_modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.025112Z", "completed_at": "2023-12-12T20:25:30.328982Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.329526Z", "completed_at": "2023-12-12T20:25:30.329529Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3785519599914551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n\n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        device_os,\n        device_type,\n        network,\n        currency_code, \n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        clicks, \n        impressions,\n        spend\n        \n        \n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.041079Z", "completed_at": "2023-12-12T20:25:30.363313Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.365908Z", "completed_at": "2023-12-12T20:25:30.365913Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3602170944213867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n\n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        clicks,\n        impressions,\n        spend\n\n        \n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.046201Z", "completed_at": "2023-12-12T20:25:30.363607Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.366215Z", "completed_at": "2023-12-12T20:25:30.366218Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.36041903495788574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n\n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        clicks,\n        impressions,\n        spend\n\n        \n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.367639Z", "completed_at": "2023-12-12T20:25:30.661408Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.661947Z", "completed_at": "2023-12-12T20:25:30.661953Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.32373666763305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    start_date\n    \n as \n    \n    start_date\n    \n, \n    \n    \n    end_date\n    \n as \n    \n    end_date\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as ad_group_id,\n        name as ad_group_name,\n        campaign_id,\n        modified_time as modified_at,\n        start_date,\n        end_date,\n        status,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.372292Z", "completed_at": "2023-12-12T20:25:30.662436Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.662945Z", "completed_at": "2023-12-12T20:25:30.662948Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3227689266204834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    title_part_1\n    \n as \n    \n    title_part_1\n    \n, \n    \n    \n    final_url\n    \n as \n    \n    final_url\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as ad_id,\n        title_part_1 as ad_name,\n        final_url,\n        ad_group_id,\n        modified_time as modified_at,\n        status,\n        type,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.407221Z", "completed_at": "2023-12-12T20:25:30.680687Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.681342Z", "completed_at": "2023-12-12T20:25:30.681348Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.305955171585083, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    time_zone\n    \n as \n    \n    time_zone\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as campaign_id,\n        name as campaign_name,\n        account_id,\n        modified_time as modified_at,\n        type,\n        time_zone,\n        status,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.402840Z", "completed_at": "2023-12-12T20:25:30.681889Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.682424Z", "completed_at": "2023-12-12T20:25:30.682428Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3068380355834961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n, \n    \n    \n    budget_association_status\n    \n as \n    \n    budget_association_status\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        budget_association_status,\n        clicks,\n        impressions,\n        spend\n\n        \n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.714961Z", "completed_at": "2023-12-12T20:25:30.723501Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.724026Z", "completed_at": "2023-12-12T20:25:30.724032Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014555215835571289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__account_history_source_relation__account_id__modified_at.c32440cfcf", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_history\"\n    group by source_relation, account_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.725715Z", "completed_at": "2023-12-12T20:25:30.731245Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.731812Z", "completed_at": "2023-12-12T20:25:30.731818Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007177114486694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__account_history_account_id.cc273ee54e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_history\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.733496Z", "completed_at": "2023-12-12T20:25:30.740865Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.741395Z", "completed_at": "2023-12-12T20:25:30.741400Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00896906852722168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__account_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_daily_report\"\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n)\n\n, joined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        accounts.time_zone as account_timezone,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend\n\n        \n\n\n\n\n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__account_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.743195Z", "completed_at": "2023-12-12T20:25:30.748576Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.749161Z", "completed_at": "2023-12-12T20:25:30.749166Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007062196731567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__account_daily_report_source_relation__date_day__account_id__device_os__device_type__network__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.38a7aa3e12", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_daily_report\"\n    group by source_relation, date_day, account_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.751307Z", "completed_at": "2023-12-12T20:25:30.754374Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.754888Z", "completed_at": "2023-12-12T20:25:30.754893Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0047359466552734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__account_daily_report_account_id.b17f45fe79", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_daily_report\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.756618Z", "completed_at": "2023-12-12T20:25:30.760628Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.761207Z", "completed_at": "2023-12-12T20:25:30.761212Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0058438777923583984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__device_os__device_type__network__language__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.b6f971641a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.763058Z", "completed_at": "2023-12-12T20:25:30.766649Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.767204Z", "completed_at": "2023-12-12T20:25:30.767208Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0052220821380615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_group_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__device_os__device_type__network__language__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.3825c46fa1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.769272Z", "completed_at": "2023-12-12T20:25:30.772296Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.772815Z", "completed_at": "2023-12-12T20:25:30.772822Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004687786102294922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_daily_report_ad_id.1ed6689aa8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_daily_report\"\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.774495Z", "completed_at": "2023-12-12T20:25:30.777674Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.778224Z", "completed_at": "2023-12-12T20:25:30.778229Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00481414794921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_group_daily_report_ad_group_id.3e03e6eff7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_daily_report\"\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.779927Z", "completed_at": "2023-12-12T20:25:30.782884Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.783490Z", "completed_at": "2023-12-12T20:25:30.783496Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004912853240966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_group_history_source_relation__ad_group_id__modified_at.f2ed2b82b0", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_group_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_history\"\n    group by source_relation, ad_group_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.785604Z", "completed_at": "2023-12-12T20:25:30.788672Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.789183Z", "completed_at": "2023-12-12T20:25:30.789188Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004701137542724609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_group_history_ad_group_id.c8353342b7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_history\"\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.790941Z", "completed_at": "2023-12-12T20:25:30.793909Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.794457Z", "completed_at": "2023-12-12T20:25:30.794463Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004658937454223633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_history_source_relation__ad_id__modified_at.2eb6255160", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_history\"\n    group by source_relation, ad_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.796135Z", "completed_at": "2023-12-12T20:25:30.799639Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.800140Z", "completed_at": "2023-12-12T20:25:30.800145Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005036115646362305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_history_ad_id.6d02c26574", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_history\"\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.801823Z", "completed_at": "2023-12-12T20:25:30.806286Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.806804Z", "completed_at": "2023-12-12T20:25:30.806809Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006097316741943359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__ad_group_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_daily_report\"\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n),\n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n),\n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n),\n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend\n\n        \n\n\n\n\n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__ad_group_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.808601Z", "completed_at": "2023-12-12T20:25:30.814535Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.815096Z", "completed_at": "2023-12-12T20:25:30.815102Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007634878158569336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__ad_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_daily_report\"\n\n), \n\nads as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_history\"\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        ads.type as ad_type,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend\n\n        \n\n\n\n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15\n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__ad_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.816917Z", "completed_at": "2023-12-12T20:25:30.844418Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.844995Z", "completed_at": "2023-12-12T20:25:30.845002Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.029153823852539062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__url_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_daily_report\"\n\n), \n\nads as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_history\"\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        '?',\n        1\n        )\n\n\n  \n\n as base_url,\n        \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        \n\n    replace(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'android-app://',\n        ''\n    )\n\n\n,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/',\n        1\n        )\n\n\n  \n\n,\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_host,\n        '/' || \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n    right(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        \n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    position(\n        '/' in \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ), 0),\n            \n\n    position(\n        '?' in \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ) - 1\n            )\n    ),\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_path,\n\n        \n\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_source=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_source,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_medium=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_medium,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_campaign=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_campaign,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_content=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_content,\n        \n\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_term=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_term,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend\n\n        \n\n\n\n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22\n), \n\nfiltered as (\n\n    select * \n    from joined\n\n    \n        where base_url is not null\n    \n)\n\nselect *\nfrom filtered", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__url_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.846832Z", "completed_at": "2023-12-12T20:25:30.849898Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.850451Z", "completed_at": "2023-12-12T20:25:30.850456Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004720926284790039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__campaign_history_source_relation__campaign_id__modified_at.56da51b12d", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_history\"\n    group by source_relation, campaign_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.852059Z", "completed_at": "2023-12-12T20:25:30.854893Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.855400Z", "completed_at": "2023-12-12T20:25:30.855405Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004351139068603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__campaign_history_campaign_id.ee080a2122", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_history\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.857002Z", "completed_at": "2023-12-12T20:25:30.860984Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.861475Z", "completed_at": "2023-12-12T20:25:30.861479Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005444049835205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__campaign_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_daily_report\"\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n),\n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n),\n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        campaigns.type as campaign_type,\n        campaigns.time_zone as campaign_timezone,\n        campaigns.status as campaign_status,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend\n\n        \n\n\n\n\n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__campaign_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.863115Z", "completed_at": "2023-12-12T20:25:30.866201Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.866732Z", "completed_at": "2023-12-12T20:25:30.866736Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004647016525268555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__campaign_daily_report_source_relation__date_day__account_id__campaign_id__device_os__device_type__network__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other__budget_association_status.eeae6c3f2f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other, budget_association_status\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other, budget_association_status\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.868357Z", "completed_at": "2023-12-12T20:25:30.871894Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.872399Z", "completed_at": "2023-12-12T20:25:30.872404Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005014896392822266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__campaign_daily_report_campaign_id.8ac0418e84", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_daily_report\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.873959Z", "completed_at": "2023-12-12T20:25:30.876884Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.877443Z", "completed_at": "2023-12-12T20:25:30.877447Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004490852355957031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__account_report_source_relation__date_day__account_id__device_os__device_type__network__currency_code.42178a7c9b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__account_report\"\n    group by source_relation, date_day, account_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.879157Z", "completed_at": "2023-12-12T20:25:30.881908Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.882396Z", "completed_at": "2023-12-12T20:25:30.882400Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00429987907409668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__account_report_account_id.f88e46157e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__account_report\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.883974Z", "completed_at": "2023-12-12T20:25:30.886735Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.887264Z", "completed_at": "2023-12-12T20:25:30.887268Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004293203353881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__ad_group_report_source_relation__date_day__account_id__campaign_id__ad_group_id__device_os__device_type__network__currency_code.da08ee00a5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__ad_group_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.888954Z", "completed_at": "2023-12-12T20:25:30.891652Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.892144Z", "completed_at": "2023-12-12T20:25:30.892148Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0042951107025146484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__ad_group_report_ad_group_id.1974ec5ab9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__ad_group_report\"\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.893732Z", "completed_at": "2023-12-12T20:25:30.897561Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.898084Z", "completed_at": "2023-12-12T20:25:30.898088Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005354166030883789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__ad_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__ad_type__device_os__device_type__network__currency_code.e13fd60438", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, ad_type, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__ad_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, ad_type, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.899638Z", "completed_at": "2023-12-12T20:25:30.941843Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.942745Z", "completed_at": "2023-12-12T20:25:30.942751Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04411911964416504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__ad_report_ad_id.b089709125", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__ad_report\"\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.944374Z", "completed_at": "2023-12-12T20:25:30.947268Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.947796Z", "completed_at": "2023-12-12T20:25:30.947801Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004422903060913086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__url_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__device_os__device_type__network__currency_code.0ea4732dff", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__url_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.949369Z", "completed_at": "2023-12-12T20:25:30.952593Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.953098Z", "completed_at": "2023-12-12T20:25:30.953103Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0047359466552734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__url_report_base_url.c1af50307a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_url\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__url_report\"\nwhere base_url is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.954733Z", "completed_at": "2023-12-12T20:25:30.957649Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.958167Z", "completed_at": "2023-12-12T20:25:30.958172Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004433870315551758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__campaign_report_source_relation__date_day__account_id__campaign_id__device_os__device_type__network__currency_code.00fc594532", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__campaign_report\"\n    group by source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.959724Z", "completed_at": "2023-12-12T20:25:30.962403Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:30.962890Z", "completed_at": "2023-12-12T20:25:30.962894Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0041468143463134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__campaign_report_campaign_id.67aa50e1f8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__campaign_report\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.696188Z", "completed_at": "2023-12-12T20:25:31.007284Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.008336Z", "completed_at": "2023-12-12T20:25:31.008339Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.34652280807495117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__keyword_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    match_type\n    \n as \n    \n    match_type\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as keyword_id,\n        name as keyword_name,\n        modified_time as modified_at,\n        ad_group_id,\n        match_type,\n        status,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__keyword_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.710973Z", "completed_at": "2023-12-12T20:25:31.002463Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.006987Z", "completed_at": "2023-12-12T20:25:31.006994Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3285219669342041, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__search_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__search_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    keyword_id\n    \n as \n    \n    keyword_id\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    search_query\n    \n as \n    \n    search_query\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n\n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        keyword_id,\n        search_query,\n        device_os,\n        device_type,\n        network,\n        language,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        clicks,\n        impressions,\n        spend\n\n        \n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__search_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:30.691755Z", "completed_at": "2023-12-12T20:25:31.008043Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.009062Z", "completed_at": "2023-12-12T20:25:31.009065Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.34815096855163574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__keyword_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    keyword_id\n    \n as \n    \n    keyword_id\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        keyword_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        clicks,\n        impressions,\n        spend\n\n        \n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__keyword_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:31.039942Z", "completed_at": "2023-12-12T20:25:31.050274Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.055983Z", "completed_at": "2023-12-12T20:25:31.055989Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019942760467529297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__search_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__search_daily_report\"\n\n), \n\nkeywords as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__keyword_history\"\n    where is_most_recent_record = True\n),\n\nads as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_history\"\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        report.keyword_id,\n        keywords.keyword_name,\n        coalesce(report.delivered_match_type, report.bid_match_type) as match_type,\n        report.search_query,\n        report.device_os,\n        report.device_type,\n        report.network,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend\n\n        \n\n\n\n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join keywords\n        on report.keyword_id = keywords.keyword_id\n        and report.source_relation = keywords.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17\n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__search_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:31.046279Z", "completed_at": "2023-12-12T20:25:31.050944Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.058800Z", "completed_at": "2023-12-12T20:25:31.058809Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014234781265258789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__keyword_history_source_relation__keyword_id__modified_at.5b0ba5f522", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, keyword_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__keyword_history\"\n    group by source_relation, keyword_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:31.052430Z", "completed_at": "2023-12-12T20:25:31.060546Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.062975Z", "completed_at": "2023-12-12T20:25:31.062979Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01680588722229004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__search_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__search_query__device_os__device_type__network__language__bid_match_type__delivered_match_type__top_vs_other.97d894068e", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, language, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__search_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, language, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:31.056267Z", "completed_at": "2023-12-12T20:25:31.060916Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.063247Z", "completed_at": "2023-12-12T20:25:31.063250Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01661992073059082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__keyword_history_keyword_id.19164a6209", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__keyword_history\"\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:31.063752Z", "completed_at": "2023-12-12T20:25:31.073654Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.075769Z", "completed_at": "2023-12-12T20:25:31.075774Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02129507064819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__search_daily_report_search_query.57f687adcc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_query\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__search_daily_report\"\nwhere search_query is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:31.067480Z", "completed_at": "2023-12-12T20:25:31.075267Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.083172Z", "completed_at": "2023-12-12T20:25:31.083176Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02166891098022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__keyword_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__keyword_daily_report\"\n\n), \n\nkeywords as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__keyword_history\"\n    where is_most_recent_record = True\n),\n\nads as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_history\"\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        keywords.keyword_name,\n        report.keyword_id,\n        keywords.match_type,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend\n\n        \n\n\n\n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join keywords\n        on report.keyword_id = keywords.keyword_id\n        and report.source_relation = keywords.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__keyword_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:31.079226Z", "completed_at": "2023-12-12T20:25:31.084397Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.086645Z", "completed_at": "2023-12-12T20:25:31.086648Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016087055206298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__keyword_daily_report_keyword_id.e16b8c5047", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__keyword_daily_report\"\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:31.076057Z", "completed_at": "2023-12-12T20:25:31.085061Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.089791Z", "completed_at": "2023-12-12T20:25:31.089796Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017028093338012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__keyword_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__device_os__device_type__network__language__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.e55a075940", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_source\".\"stg_microsoft_ads__keyword_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:31.086889Z", "completed_at": "2023-12-12T20:25:31.094212Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.096371Z", "completed_at": "2023-12-12T20:25:31.096376Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015386104583740234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__search_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__search_query__device_os__device_type__network__match_type.6753357660", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, match_type\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__search_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, match_type\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:31.091355Z", "completed_at": "2023-12-12T20:25:31.095491Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.100431Z", "completed_at": "2023-12-12T20:25:31.100435Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017204999923706055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__search_report_search_query.fa3625d66d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_query\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__search_report\"\nwhere search_query is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:31.097106Z", "completed_at": "2023-12-12T20:25:31.103940Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.104548Z", "completed_at": "2023-12-12T20:25:31.104551Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01021718978881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__keyword_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__device_os__device_type__network__currency_code.e4af52a80b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__keyword_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:25:31.100697Z", "completed_at": "2023-12-12T20:25:31.105334Z"}, {"name": "execute", "started_at": "2023-12-12T20:25:31.105844Z", "completed_at": "2023-12-12T20:25:31.105847Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010512113571166992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__keyword_report_keyword_id.da1d648d3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads\".\"microsoft_ads__keyword_report\"\nwhere keyword_id is null\n\n\n", "relation_name": null}], "elapsed_time": 2.238968849182129, "args": {"target": "postgres", "partial_parse": true, "static": false, "version_check": true, "which": "generate", "enable_legacy_logger": false, "use_colors_file": true, "write_json": true, "printer_width": 80, "indirect_selection": "eager", "log_file_max_bytes": 10485760, "compile": true, "log_format": "default", "partial_parse_file_diff": true, "project_dir": "/Users/joseph.markiewicz/Documents/dbt_packages/ad_reporting/microsoft/dbt_microsoft_ads/integration_tests", "exclude": [], "introspect": true, "invocation_command": "dbt docs generate -t postgres", "select": [], "vars": {}, "print": true, "use_colors": true, "show_resource_report": false, "profiles_dir": "/Users/joseph.markiewicz/.dbt", "send_anonymous_usage_stats": true, "quiet": false, "cache_selected_only": false, "favor_state": false, "log_format_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "empty_catalog": false, "populate_cache": true, "macro_debugging": false, "defer": false, "log_level_file": "debug", "log_path": "/Users/joseph.markiewicz/Documents/dbt_packages/ad_reporting/microsoft/dbt_microsoft_ads/integration_tests/logs", "static_parser": true, "log_level": "info", "strict_mode": false}}