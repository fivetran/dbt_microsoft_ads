{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.18", "generated_at": "2024-08-20T23:37:25.536295Z", "invocation_id": "1d0bc943-d308-46fc-8a47-7f1842cb7aa4", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.512032Z", "completed_at": "2024-08-20T23:37:22.515820Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.517840Z", "completed_at": "2024-08-20T23:37:22.517853Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.046872854232788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_ad_group_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.509344Z", "completed_at": "2024-08-20T23:37:22.516129Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.518098Z", "completed_at": "2024-08-20T23:37:22.518101Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04776406288146973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_ad_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.493401Z", "completed_at": "2024-08-20T23:37:22.516382Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.518349Z", "completed_at": "2024-08-20T23:37:22.518352Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04857802391052246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_account_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.473354Z", "completed_at": "2024-08-20T23:37:22.516624Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.518588Z", "completed_at": "2024-08-20T23:37:22.518594Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04948616027832031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_account_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.526916Z", "completed_at": "2024-08-20T23:37:22.535792Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.537030Z", "completed_at": "2024-08-20T23:37:22.537036Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01593303680419922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_ad_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.524072Z", "completed_at": "2024-08-20T23:37:22.536065Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.537791Z", "completed_at": "2024-08-20T23:37:22.537795Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0172269344329834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_ad_group_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.530176Z", "completed_at": "2024-08-20T23:37:22.536581Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.538752Z", "completed_at": "2024-08-20T23:37:22.538756Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017600059509277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_campaign_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.532976Z", "completed_at": "2024-08-20T23:37:22.537250Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.539817Z", "completed_at": "2024-08-20T23:37:22.539820Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018327713012695312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_campaign_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.552519Z", "completed_at": "2024-08-20T23:37:22.553492Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.555229Z", "completed_at": "2024-08-20T23:37:22.555233Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010387897491455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_account_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.546466Z", "completed_at": "2024-08-20T23:37:22.553801Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.555458Z", "completed_at": "2024-08-20T23:37:22.555461Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014899253845214844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_keyword_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.543265Z", "completed_at": "2024-08-20T23:37:22.554085Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.555887Z", "completed_at": "2024-08-20T23:37:22.555889Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016628026962280273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_keyword_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.549272Z", "completed_at": "2024-08-20T23:37:22.554769Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.557019Z", "completed_at": "2024-08-20T23:37:22.557022Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01571798324584961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__search_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_search_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__search_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.561289Z", "completed_at": "2024-08-20T23:37:22.562373Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.566909Z", "completed_at": "2024-08-20T23:37:22.566914Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009015083312988281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_account_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.562657Z", "completed_at": "2024-08-20T23:37:22.563573Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.567149Z", "completed_at": "2024-08-20T23:37:22.567152Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009119987487792969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_group_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.564028Z", "completed_at": "2024-08-20T23:37:22.564922Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.567566Z", "completed_at": "2024-08-20T23:37:22.567569Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00920414924621582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_group_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.565586Z", "completed_at": "2024-08-20T23:37:22.566457Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.568663Z", "completed_at": "2024-08-20T23:37:22.568665Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009417057037353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.573235Z", "completed_at": "2024-08-20T23:37:22.575077Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.579373Z", "completed_at": "2024-08-20T23:37:22.579378Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009916305541992188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.575362Z", "completed_at": "2024-08-20T23:37:22.576213Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.579596Z", "completed_at": "2024-08-20T23:37:22.579598Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009968996047973633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.576654Z", "completed_at": "2024-08-20T23:37:22.577490Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.580025Z", "completed_at": "2024-08-20T23:37:22.580027Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009790897369384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_campaign_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.578111Z", "completed_at": "2024-08-20T23:37:22.578952Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.581123Z", "completed_at": "2024-08-20T23:37:22.581125Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009881019592285156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_keyword_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.585187Z", "completed_at": "2024-08-20T23:37:22.586491Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.599330Z", "completed_at": "2024-08-20T23:37:22.599335Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01731085777282715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_keyword_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.586835Z", "completed_at": "2024-08-20T23:37:22.587800Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:22.599780Z", "completed_at": "2024-08-20T23:37:22.599782Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01758599281311035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_search_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.608263Z", "completed_at": "2024-08-20T23:37:23.480454Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:23.481806Z", "completed_at": "2024-08-20T23:37:23.481811Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.9622931480407715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n, \n    \n    \n    conversions_qualified\n    \n as \n    \n    conversions_qualified\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    revenue\n    \n as \n    \n    revenue\n    \n, \n    cast(null as integer) as \n    \n    all_conversions\n    \n , \n    \n    \n    all_conversions_qualified\n    \n as \n    \n    all_conversions_qualified\n    \n, \n    cast(null as numeric(28,6)) as \n    \n    all_revenue\n    \n \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        device_os,\n        device_type,\n        network,\n        currency_code, \n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(conversions_qualified, conversions), 0) as conversions,\n        coalesce(revenue, 0) as conversions_value,\n        coalesce(all_conversions_qualified, 0) as all_conversions   \n\n        \n\n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.595481Z", "completed_at": "2024-08-20T23:37:23.479388Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:23.479973Z", "completed_at": "2024-08-20T23:37:23.479981Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.9819180965423584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n, \n    \n    \n    conversions_qualified\n    \n as \n    \n    conversions_qualified\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    revenue\n    \n as \n    \n    revenue\n    \n, \n    \n    \n    all_conversions\n    \n as \n    \n    all_conversions\n    \n, \n    \n    \n    all_conversions_qualified\n    \n as \n    \n    all_conversions_qualified\n    \n, \n    \n    \n    all_revenue\n    \n as \n    \n    all_revenue\n    \n\n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(conversions_qualified, conversions), 0) as conversions,\n        coalesce(revenue, 0) as conversions_value,\n        coalesce(coalesce(all_conversions_qualified, all_conversions), 0) as all_conversions,\n        coalesce(all_revenue, 0) as all_conversions_value\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.603681Z", "completed_at": "2024-08-20T23:37:23.480827Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:23.482042Z", "completed_at": "2024-08-20T23:37:23.482044Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9647002220153809, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    last_modified_time\n    \n as \n    \n    last_modified_time\n    \n, \n    \n    \n    time_zone\n    \n as \n    \n    time_zone\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as account_id,\n        name as account_name,\n        last_modified_time as modified_at,\n        time_zone,\n        currency_code,\n        row_number() over (partition by source_relation, id order by last_modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:22.588274Z", "completed_at": "2024-08-20T23:37:23.481561Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:23.483090Z", "completed_at": "2024-08-20T23:37:23.483094Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.9839940071105957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n, \n    \n    \n    conversions_qualified\n    \n as \n    \n    conversions_qualified\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    revenue\n    \n as \n    \n    revenue\n    \n, \n    \n    \n    all_conversions\n    \n as \n    \n    all_conversions\n    \n, \n    \n    \n    all_conversions_qualified\n    \n as \n    \n    all_conversions_qualified\n    \n, \n    \n    \n    all_revenue\n    \n as \n    \n    all_revenue\n    \n\n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(conversions_qualified, conversions), 0) as conversions,\n        coalesce(revenue, 0) as conversions_value,\n        coalesce(coalesce(all_conversions_qualified, all_conversions), 0) as all_conversions,\n        coalesce(all_revenue, 0) as all_conversions_value\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:23.576264Z", "completed_at": "2024-08-20T23:37:24.419984Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.420517Z", "completed_at": "2024-08-20T23:37:24.420524Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.9337859153747559, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    start_date\n    \n as \n    \n    start_date\n    \n, \n    \n    \n    end_date\n    \n as \n    \n    end_date\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as ad_group_id,\n        name as ad_group_name,\n        campaign_id,\n        modified_time as modified_at,\n        start_date,\n        end_date,\n        status,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:23.570067Z", "completed_at": "2024-08-20T23:37:24.425928Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.426387Z", "completed_at": "2024-08-20T23:37:24.426391Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.9449608325958252, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    title_part_1\n    \n as \n    \n    title_part_1\n    \n, \n    \n    \n    final_url\n    \n as \n    \n    final_url\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as ad_id,\n        title_part_1 as ad_name,\n        final_url,\n        ad_group_id,\n        modified_time as modified_at,\n        status,\n        type,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:23.612046Z", "completed_at": "2024-08-20T23:37:24.470984Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.471447Z", "completed_at": "2024-08-20T23:37:24.471450Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9883561134338379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n, \n    \n    \n    budget_association_status\n    \n as \n    \n    budget_association_status\n    \n, \n    \n    \n    budget_name\n    \n as \n    \n    budget_name\n    \n, \n    cast(null as TEXT) as \n    \n    budget_status\n    \n , \n    \n    \n    conversions_qualified\n    \n as \n    \n    conversions_qualified\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    revenue\n    \n as \n    \n    revenue\n    \n, \n    \n    \n    all_conversions\n    \n as \n    \n    all_conversions\n    \n, \n    \n    \n    all_conversions_qualified\n    \n as \n    \n    all_conversions_qualified\n    \n, \n    \n    \n    all_revenue\n    \n as \n    \n    all_revenue\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        budget_association_status,\n        budget_name,\n        budget_status,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(conversions_qualified, conversions), 0) as conversions,\n        coalesce(revenue, 0) as conversions_value,\n        coalesce(coalesce(all_conversions_qualified, all_conversions), 0) as all_conversions,\n        coalesce(all_revenue, 0) as all_conversions_value\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:23.616825Z", "completed_at": "2024-08-20T23:37:24.469948Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.470481Z", "completed_at": "2024-08-20T23:37:24.470487Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.9837541580200195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    time_zone\n    \n as \n    \n    time_zone\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as campaign_id,\n        name as campaign_name,\n        account_id,\n        modified_time as modified_at,\n        type,\n        time_zone,\n        status,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.567201Z", "completed_at": "2024-08-20T23:37:24.579601Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.580141Z", "completed_at": "2024-08-20T23:37:24.580148Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0203859806060791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__account_daily_report_source_relation__date_day__account_id__device_os__device_type__network__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.38a7aa3e12", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_daily_report\"\n    group by source_relation, date_day, account_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.581682Z", "completed_at": "2024-08-20T23:37:24.587456Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.587973Z", "completed_at": "2024-08-20T23:37:24.587978Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007261991500854492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__account_daily_report_account_id.b17f45fe79", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_daily_report\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.589464Z", "completed_at": "2024-08-20T23:37:24.597510Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.598083Z", "completed_at": "2024-08-20T23:37:24.598089Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009546041488647461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__account_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_daily_report\"\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n)\n\n, joined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        accounts.time_zone as account_timezone,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value,\n        sum(report.all_conversions) as all_conversions\n\n        \n\n\n\n    \n    \n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__account_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.599851Z", "completed_at": "2024-08-20T23:37:24.603277Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.603783Z", "completed_at": "2024-08-20T23:37:24.603789Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005063772201538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__account_history_source_relation__account_id__modified_at.c32440cfcf", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    group by source_relation, account_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.605401Z", "completed_at": "2024-08-20T23:37:24.609704Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.610208Z", "completed_at": "2024-08-20T23:37:24.610214Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005815982818603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__device_os__device_type__network__language__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.b6f971641a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.611752Z", "completed_at": "2024-08-20T23:37:24.614655Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.615124Z", "completed_at": "2024-08-20T23:37:24.615128Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004320859909057617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__account_history_account_id.cc273ee54e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.616883Z", "completed_at": "2024-08-20T23:37:24.620694Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.621145Z", "completed_at": "2024-08-20T23:37:24.621150Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005381107330322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_daily_report_ad_id.1ed6689aa8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_daily_report\"\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.622657Z", "completed_at": "2024-08-20T23:37:24.625598Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.626101Z", "completed_at": "2024-08-20T23:37:24.626105Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004428863525390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_group_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__device_os__device_type__network__language__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.3825c46fa1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.627579Z", "completed_at": "2024-08-20T23:37:24.630228Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.630682Z", "completed_at": "2024-08-20T23:37:24.630686Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004005908966064453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_group_daily_report_ad_group_id.3e03e6eff7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_daily_report\"\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.632101Z", "completed_at": "2024-08-20T23:37:24.634766Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.635224Z", "completed_at": "2024-08-20T23:37:24.635228Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004027843475341797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_group_history_source_relation__ad_group_id__modified_at.f2ed2b82b0", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_group_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\"\n    group by source_relation, ad_group_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.636643Z", "completed_at": "2024-08-20T23:37:24.639536Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.639971Z", "completed_at": "2024-08-20T23:37:24.639976Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004214048385620117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_group_history_ad_group_id.c8353342b7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\"\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.641567Z", "completed_at": "2024-08-20T23:37:24.645299Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.645824Z", "completed_at": "2024-08-20T23:37:24.645829Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005352973937988281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_history_source_relation__ad_id__modified_at.2eb6255160", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history\"\n    group by source_relation, ad_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.647388Z", "completed_at": "2024-08-20T23:37:24.650114Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.650539Z", "completed_at": "2024-08-20T23:37:24.650544Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004054069519042969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_history_ad_id.6d02c26574", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history\"\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.652230Z", "completed_at": "2024-08-20T23:37:24.656377Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.656953Z", "completed_at": "2024-08-20T23:37:24.656964Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0059168338775634766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__campaign_daily_report_source_relation__date_day__account_id__campaign_id__device_os__device_type__network__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other__budget_association_status__budget_name__budget_status.f7a5fd8430", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other, budget_association_status, budget_name, budget_status\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other, budget_association_status, budget_name, budget_status\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.658641Z", "completed_at": "2024-08-20T23:37:24.661447Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.661911Z", "completed_at": "2024-08-20T23:37:24.661916Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004286050796508789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__campaign_daily_report_campaign_id.8ac0418e84", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_daily_report\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.663379Z", "completed_at": "2024-08-20T23:37:24.668109Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.668596Z", "completed_at": "2024-08-20T23:37:24.668601Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006154060363769531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__ad_group_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_daily_report\"\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n),\n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n),\n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n),\n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value, \n        sum(report.all_conversions) as all_conversions,\n        sum(report.all_conversions_value) as all_conversions_value\n\n        \n\n\n\n    \n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__ad_group_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.670319Z", "completed_at": "2024-08-20T23:37:24.676332Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.676739Z", "completed_at": "2024-08-20T23:37:24.676744Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007458925247192383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__ad_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_daily_report\"\n\n), \n\nads as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history\"\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        ads.type as ad_type,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value,\n        sum(report.all_conversions) as all_conversions,\n        sum(report.all_conversions_value) as all_conversions_value\n\n        \n\n\n\n    \n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15\n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__ad_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.678378Z", "completed_at": "2024-08-20T23:37:24.682608Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.683038Z", "completed_at": "2024-08-20T23:37:24.683042Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0058078765869140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__campaign_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_daily_report\"\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n),\n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n),\n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        campaigns.type as campaign_type,\n        campaigns.time_zone as campaign_timezone,\n        campaigns.status as campaign_status,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value,\n        sum(report.all_conversions) as all_conversions,\n        sum(report.all_conversions_value) as all_conversions_value\n\n        \n\n\n\n \n\n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__campaign_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.684766Z", "completed_at": "2024-08-20T23:37:24.712601Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.713150Z", "completed_at": "2024-08-20T23:37:24.713157Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029548168182373047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__url_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_daily_report\"\n\n), \n\nads as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history\"\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        '?',\n        1\n        )\n\n\n  \n\n as base_url,\n        \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        \n\n    replace(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'android-app://',\n        ''\n    )\n\n\n,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/',\n        1\n        )\n\n\n  \n\n,\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_host,\n        '/' || \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n    right(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        \n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    position(\n        '/' in \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ), 0),\n            \n\n    position(\n        '?' in \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ) - 1\n            )\n    ),\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_path,\n\n        \n\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_source=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_source,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_medium=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_medium,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_campaign=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_campaign,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_content=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_content,\n        \n\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_term=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_term,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value,\n        sum(report.all_conversions) as all_conversions,\n        sum(report.all_conversions_value) as all_conversions_value\n\n        \n\n\n\n\n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22\n), \n\nfiltered as (\n\n    select * \n    from joined\n\n    \n        where base_url is not null\n    \n)\n\nselect *\nfrom filtered", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__url_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.714827Z", "completed_at": "2024-08-20T23:37:24.718648Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.719136Z", "completed_at": "2024-08-20T23:37:24.719141Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0052988529205322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__campaign_history_source_relation__campaign_id__modified_at.56da51b12d", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\n    group by source_relation, campaign_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.720762Z", "completed_at": "2024-08-20T23:37:24.723394Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.723817Z", "completed_at": "2024-08-20T23:37:24.723821Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0040798187255859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__campaign_history_campaign_id.ee080a2122", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.725508Z", "completed_at": "2024-08-20T23:37:24.728777Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.729289Z", "completed_at": "2024-08-20T23:37:24.729294Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004918575286865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__account_report_source_relation__date_day__account_id__device_os__device_type__network__currency_code.42178a7c9b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__account_report\"\n    group by source_relation, date_day, account_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.730772Z", "completed_at": "2024-08-20T23:37:24.733560Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.734034Z", "completed_at": "2024-08-20T23:37:24.734038Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0041692256927490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__account_report_account_id.f88e46157e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__account_report\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.735639Z", "completed_at": "2024-08-20T23:37:24.738466Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.738948Z", "completed_at": "2024-08-20T23:37:24.738953Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004333019256591797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__ad_group_report_source_relation__date_day__account_id__campaign_id__ad_group_id__device_os__device_type__network__currency_code.da08ee00a5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__ad_group_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.740410Z", "completed_at": "2024-08-20T23:37:24.743811Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.744265Z", "completed_at": "2024-08-20T23:37:24.744271Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004778861999511719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__ad_group_report_ad_group_id.1974ec5ab9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__ad_group_report\"\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.745921Z", "completed_at": "2024-08-20T23:37:24.749120Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.749570Z", "completed_at": "2024-08-20T23:37:24.749574Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004647016525268555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__ad_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__ad_type__device_os__device_type__network__currency_code.e13fd60438", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, ad_type, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__ad_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, ad_type, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.751199Z", "completed_at": "2024-08-20T23:37:24.754262Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.754743Z", "completed_at": "2024-08-20T23:37:24.754749Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004640102386474609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__ad_report_ad_id.b089709125", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__ad_report\"\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.756309Z", "completed_at": "2024-08-20T23:37:24.759312Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.759815Z", "completed_at": "2024-08-20T23:37:24.759821Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004477977752685547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__campaign_report_source_relation__date_day__account_id__campaign_id__device_os__device_type__network__currency_code.00fc594532", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__campaign_report\"\n    group by source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.761531Z", "completed_at": "2024-08-20T23:37:24.764499Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.764928Z", "completed_at": "2024-08-20T23:37:24.764933Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00449681282043457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__campaign_report_campaign_id.67aa50e1f8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__campaign_report\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.766552Z", "completed_at": "2024-08-20T23:37:24.770660Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.771084Z", "completed_at": "2024-08-20T23:37:24.771087Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005605220794677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__url_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__device_os__device_type__network__currency_code.0ea4732dff", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__url_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.772715Z", "completed_at": "2024-08-20T23:37:24.775943Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:24.776422Z", "completed_at": "2024-08-20T23:37:24.776427Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004797935485839844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__url_report_base_url.c1af50307a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_url\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__url_report\"\nwhere base_url is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.513472Z", "completed_at": "2024-08-20T23:37:25.356645Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.357140Z", "completed_at": "2024-08-20T23:37:25.357146Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.9301049709320068, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    keyword_id\n    \n as \n    \n    keyword_id\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n, \n    \n    \n    conversions_qualified\n    \n as \n    \n    conversions_qualified\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    revenue\n    \n as \n    \n    revenue\n    \n, \n    \n    \n    all_conversions\n    \n as \n    \n    all_conversions\n    \n, \n    \n    \n    all_conversions_qualified\n    \n as \n    \n    all_conversions_qualified\n    \n, \n    \n    \n    all_revenue\n    \n as \n    \n    all_revenue\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        keyword_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(conversions_qualified, conversions), 0) as conversions,\n        coalesce(revenue, 0) as conversions_value,\n        coalesce(coalesce(all_conversions_qualified, all_conversions), 0) as all_conversions,\n        coalesce(all_revenue, 0) as all_conversions_value\n\n        \n\n\n\n\n    \n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:25.445083Z", "completed_at": "2024-08-20T23:37:25.452380Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.452901Z", "completed_at": "2024-08-20T23:37:25.452907Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009565353393554688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__keyword_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__device_os__device_type__network__language__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.e55a075940", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:25.449054Z", "completed_at": "2024-08-20T23:37:25.453932Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.454524Z", "completed_at": "2024-08-20T23:37:25.454528Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010336875915527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__keyword_daily_report_keyword_id.e16b8c5047", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_daily_report\"\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.560572Z", "completed_at": "2024-08-20T23:37:25.384952Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.385915Z", "completed_at": "2024-08-20T23:37:25.385924Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9185280799865723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__search_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__search_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    keyword_id\n    \n as \n    \n    keyword_id\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    search_query\n    \n as \n    \n    search_query\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n, \n    \n    \n    conversions_qualified\n    \n as \n    \n    conversions_qualified\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    revenue\n    \n as \n    \n    revenue\n    \n, \n    \n    \n    all_conversions\n    \n as \n    \n    all_conversions\n    \n, \n    \n    \n    all_conversions_qualified\n    \n as \n    \n    all_conversions_qualified\n    \n, \n    \n    \n    all_revenue\n    \n as \n    \n    all_revenue\n    \n\n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        keyword_id,\n        search_query,\n        device_os,\n        device_type,\n        network,\n        language,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(conversions_qualified, conversions), 0) as conversions,\n        coalesce(revenue, 0) as conversions_value,\n        coalesce(coalesce(all_conversions_qualified, all_conversions), 0) as all_conversions,\n        coalesce(all_revenue, 0) as all_conversions_value\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__search_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:24.504191Z", "completed_at": "2024-08-20T23:37:25.385238Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.386154Z", "completed_at": "2024-08-20T23:37:25.386156Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.9770491123199463, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    match_type\n    \n as \n    \n    match_type\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as keyword_id,\n        name as keyword_name,\n        modified_time as modified_at,\n        ad_group_id,\n        match_type,\n        status,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:25.481039Z", "completed_at": "2024-08-20T23:37:25.488682Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.501162Z", "completed_at": "2024-08-20T23:37:25.501169Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023662090301513672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__search_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__search_query__device_os__device_type__network__language__bid_match_type__delivered_match_type__top_vs_other.97d894068e", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, language, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__search_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, language, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:25.484414Z", "completed_at": "2024-08-20T23:37:25.488929Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.501483Z", "completed_at": "2024-08-20T23:37:25.501487Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02347111701965332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__search_daily_report_search_query.57f687adcc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_query\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__search_daily_report\"\nwhere search_query is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:25.489212Z", "completed_at": "2024-08-20T23:37:25.501748Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.503958Z", "completed_at": "2024-08-20T23:37:25.503962Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01771688461303711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__keyword_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_daily_report\"\n\n), \n\nkeywords as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_history\"\n    where is_most_recent_record = True\n),\n\nads as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history\"\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        keywords.keyword_name,\n        report.keyword_id,\n        keywords.match_type,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value,\n        sum(report.all_conversions) as all_conversions,\n        sum(report.all_conversions_value) as all_conversions_value\n\n        \n\n\n\n\n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join keywords\n        on report.keyword_id = keywords.keyword_id\n        and report.source_relation = keywords.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__keyword_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:25.494725Z", "completed_at": "2024-08-20T23:37:25.501965Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.504197Z", "completed_at": "2024-08-20T23:37:25.504200Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017756223678588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__search_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__search_daily_report\"\n\n), \n\nkeywords as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_history\"\n    where is_most_recent_record = True\n),\n\nads as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history\"\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        report.keyword_id,\n        keywords.keyword_name,\n        coalesce(report.delivered_match_type, report.bid_match_type) as match_type,\n        report.search_query,\n        report.device_os,\n        report.device_type,\n        report.network,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value,\n        sum(report.all_conversions) as all_conversions,\n        sum(report.all_conversions_value) as all_conversions_value\n\n        \n\n\n\n\n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join keywords\n        on report.keyword_id = keywords.keyword_id\n        and report.source_relation = keywords.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17\n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__search_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:25.509556Z", "completed_at": "2024-08-20T23:37:25.513480Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.520538Z", "completed_at": "2024-08-20T23:37:25.520544Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016549110412597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__keyword_history_keyword_id.19164a6209", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_history\"\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:25.506910Z", "completed_at": "2024-08-20T23:37:25.513707Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.520871Z", "completed_at": "2024-08-20T23:37:25.520874Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017360925674438477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__keyword_history_source_relation__keyword_id__modified_at.5b0ba5f522", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, keyword_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_history\"\n    group by source_relation, keyword_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:25.513927Z", "completed_at": "2024-08-20T23:37:25.522045Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.524299Z", "completed_at": "2024-08-20T23:37:25.524305Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01332712173461914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__keyword_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__device_os__device_type__network__currency_code.e4af52a80b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__keyword_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:25.516551Z", "completed_at": "2024-08-20T23:37:25.522276Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.524603Z", "completed_at": "2024-08-20T23:37:25.524607Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013386011123657227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__search_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__search_query__device_os__device_type__network__match_type.6753357660", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, match_type\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__search_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, match_type\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:25.526180Z", "completed_at": "2024-08-20T23:37:25.532727Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.533664Z", "completed_at": "2024-08-20T23:37:25.533669Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010776996612548828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__keyword_report_keyword_id.da1d648d3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__keyword_report\"\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T23:37:25.529918Z", "completed_at": "2024-08-20T23:37:25.532975Z"}, {"name": "execute", "started_at": "2024-08-20T23:37:25.533901Z", "completed_at": "2024-08-20T23:37:25.533904Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010864973068237305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__search_report_search_query.fa3625d66d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_query\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__search_report\"\nwhere search_query is null\n\n\n", "relation_name": null}], "elapsed_time": 5.741720914840698, "args": {"log_path": "/Users/avinash.kunnath/Documents/dbt_packages/microsoft_ads/dbt_microsoft_ads/integration_tests/logs", "strict_mode": false, "send_anonymous_usage_stats": true, "partial_parse_file_diff": true, "require_explicit_package_overrides_for_builtin_materializations": false, "use_colors": true, "exclude": [], "defer": false, "static": false, "use_colors_file": true, "invocation_command": "dbt docs generate -t postgres", "partial_parse": true, "profiles_dir": "/Users/avinash.kunnath/.dbt", "log_format_file": "debug", "log_level_file": "debug", "log_file_max_bytes": 10485760, "show_resource_report": false, "printer_width": 80, "version_check": true, "which": "generate", "favor_state": false, "target": "postgres", "enable_legacy_logger": false, "populate_cache": true, "warn_error_options": {"include": [], "exclude": []}, "log_level": "info", "print": true, "quiet": false, "static_parser": true, "empty_catalog": false, "macro_debugging": false, "log_format": "default", "cache_selected_only": false, "write_json": true, "indirect_selection": "eager", "introspect": true, "project_dir": "/Users/avinash.kunnath/Documents/dbt_packages/microsoft_ads/dbt_microsoft_ads/integration_tests", "select": [], "compile": true, "vars": {}}}