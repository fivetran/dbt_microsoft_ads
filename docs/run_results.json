{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-07-09T21:39:13.026310Z", "invocation_id": "fb9a6550-beb0-42c8-9a6b-dbc99e05e064", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.510520Z", "completed_at": "2024-07-09T21:39:11.587861Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.588481Z", "completed_at": "2024-07-09T21:39:11.588500Z"}], "thread_id": "Thread-1", "execution_time": 0.0836629867553711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`microsoft_ads_source`.`microsoft_ads_account_performance_daily_report_data`", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_daily_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.521790Z", "completed_at": "2024-07-09T21:39:11.593252Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.594427Z", "completed_at": "2024-07-09T21:39:11.594431Z"}], "thread_id": "Thread-2", "execution_time": 0.08853387832641602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`microsoft_ads_source`.`microsoft_ads_account_history_data`", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.540667Z", "completed_at": "2024-07-09T21:39:11.593820Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.596211Z", "completed_at": "2024-07-09T21:39:11.596215Z"}], "thread_id": "Thread-3", "execution_time": 0.08905410766601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`microsoft_ads_source`.`microsoft_ads_ad_performance_daily_report_data`", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_daily_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.582909Z", "completed_at": "2024-07-09T21:39:11.594120Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.596485Z", "completed_at": "2024-07-09T21:39:11.596488Z"}], "thread_id": "Thread-4", "execution_time": 0.08872294425964355, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`microsoft_ads_source`.`microsoft_ads_ad_group_performance_daily_report_data`", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_daily_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.590232Z", "completed_at": "2024-07-09T21:39:11.594706Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.597054Z", "completed_at": "2024-07-09T21:39:11.597058Z"}], "thread_id": "Thread-1", "execution_time": 0.009379863739013672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`microsoft_ads_source`.`microsoft_ads_ad_group_history_data`", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.601338Z", "completed_at": "2024-07-09T21:39:11.615126Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.616052Z", "completed_at": "2024-07-09T21:39:11.616059Z"}], "thread_id": "Thread-2", "execution_time": 0.018254995346069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`microsoft_ads_source`.`microsoft_ads_ad_history_data`", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.605556Z", "completed_at": "2024-07-09T21:39:11.617323Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.619898Z", "completed_at": "2024-07-09T21:39:11.619902Z"}], "thread_id": "Thread-3", "execution_time": 0.023669004440307617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`microsoft_ads_source`.`microsoft_ads_campaign_performance_daily_report_data`", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_daily_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.611213Z", "completed_at": "2024-07-09T21:39:11.618230Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.623399Z", "completed_at": "2024-07-09T21:39:11.623405Z"}], "thread_id": "Thread-1", "execution_time": 0.020364046096801758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`microsoft_ads_source`.`microsoft_ads_keyword_performance_daily_report_data`", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__keyword_daily_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.608428Z", "completed_at": "2024-07-09T21:39:11.618527Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.623702Z", "completed_at": "2024-07-09T21:39:11.623706Z"}], "thread_id": "Thread-4", "execution_time": 0.02439427375793457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`microsoft_ads_source`.`microsoft_ads_campaign_history_data`", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.620180Z", "completed_at": "2024-07-09T21:39:11.626584Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.629028Z", "completed_at": "2024-07-09T21:39:11.629032Z"}], "thread_id": "Thread-2", "execution_time": 0.01767873764038086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`microsoft_ads_source`.`microsoft_ads_keyword_history_data`", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__keyword_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.632313Z", "completed_at": "2024-07-09T21:39:11.633488Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.636809Z", "completed_at": "2024-07-09T21:39:11.636812Z"}], "thread_id": "Thread-1", "execution_time": 0.010856866836547852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_account_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.633812Z", "completed_at": "2024-07-09T21:39:11.634892Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.637112Z", "completed_at": "2024-07-09T21:39:11.637115Z"}], "thread_id": "Thread-4", "execution_time": 0.010973215103149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_account_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.629293Z", "completed_at": "2024-07-09T21:39:11.636551Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.639273Z", "completed_at": "2024-07-09T21:39:11.639277Z"}], "thread_id": "Thread-3", "execution_time": 0.014873266220092773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__search_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`microsoft_ads_source`.`microsoft_ads_search_performance_daily_report_data`", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__search_daily_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.640110Z", "completed_at": "2024-07-09T21:39:11.641319Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.643868Z", "completed_at": "2024-07-09T21:39:11.643871Z"}], "thread_id": "Thread-2", "execution_time": 0.01086115837097168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_group_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.644534Z", "completed_at": "2024-07-09T21:39:11.646399Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.650919Z", "completed_at": "2024-07-09T21:39:11.650923Z"}], "thread_id": "Thread-1", "execution_time": 0.010111093521118164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_group_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.646679Z", "completed_at": "2024-07-09T21:39:11.647743Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.651177Z", "completed_at": "2024-07-09T21:39:11.651180Z"}], "thread_id": "Thread-4", "execution_time": 0.010220766067504883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.649549Z", "completed_at": "2024-07-09T21:39:11.650645Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.653235Z", "completed_at": "2024-07-09T21:39:11.653239Z"}], "thread_id": "Thread-3", "execution_time": 0.011448860168457031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.654024Z", "completed_at": "2024-07-09T21:39:11.655137Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.657558Z", "completed_at": "2024-07-09T21:39:11.657562Z"}], "thread_id": "Thread-2", "execution_time": 0.01029515266418457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.658173Z", "completed_at": "2024-07-09T21:39:11.659285Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.664343Z", "completed_at": "2024-07-09T21:39:11.664346Z"}], "thread_id": "Thread-1", "execution_time": 0.009714841842651367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_campaign_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.659558Z", "completed_at": "2024-07-09T21:39:11.661273Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.664608Z", "completed_at": "2024-07-09T21:39:11.664610Z"}], "thread_id": "Thread-4", "execution_time": 0.009829998016357422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_keyword_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.662943Z", "completed_at": "2024-07-09T21:39:11.664057Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.666643Z", "completed_at": "2024-07-09T21:39:11.666647Z"}], "thread_id": "Thread-3", "execution_time": 0.011148929595947266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_keyword_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.667410Z", "completed_at": "2024-07-09T21:39:11.668502Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:11.670910Z", "completed_at": "2024-07-09T21:39:11.670913Z"}], "thread_id": "Thread-2", "execution_time": 0.012774229049682617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_search_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.674602Z", "completed_at": "2024-07-09T21:39:12.061572Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.063143Z", "completed_at": "2024-07-09T21:39:12.063150Z"}], "thread_id": "Thread-4", "execution_time": 0.39479804039001465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    last_modified_time\n    \n as \n    \n    last_modified_time\n    \n, \n    \n    \n    time_zone\n    \n as \n    \n    time_zone\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as account_id,\n        name as account_name,\n        last_modified_time as modified_at,\n        time_zone,\n        currency_code,\n        row_number() over (partition by source_relation, id order by last_modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.684957Z", "completed_at": "2024-07-09T21:39:12.061964Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.063949Z", "completed_at": "2024-07-09T21:39:12.063952Z"}], "thread_id": "Thread-2", "execution_time": 0.38204097747802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_daily_report_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n\n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        clicks,\n        impressions,\n        spend\n\n        \n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_daily_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.671532Z", "completed_at": "2024-07-09T21:39:12.062548Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.064787Z", "completed_at": "2024-07-09T21:39:12.064790Z"}], "thread_id": "Thread-1", "execution_time": 0.39708805084228516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_daily_report_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n\n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        device_os,\n        device_type,\n        network,\n        currency_code, \n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        clicks, \n        impressions,\n        spend\n        \n        \n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_daily_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:11.679478Z", "completed_at": "2024-07-09T21:39:12.063690Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.066759Z", "completed_at": "2024-07-09T21:39:12.066762Z"}], "thread_id": "Thread-3", "execution_time": 0.3970937728881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_daily_report_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n\n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        clicks,\n        impressions,\n        spend\n\n        \n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_daily_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.129022Z", "completed_at": "2024-07-09T21:39:12.547637Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.549807Z", "completed_at": "2024-07-09T21:39:12.549814Z"}], "thread_id": "Thread-1", "execution_time": 0.48207521438598633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_daily_report_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n, \n    \n    \n    budget_association_status\n    \n as \n    \n    budget_association_status\n    \n, \n    cast(null as string) as \n    \n    budget_name\n    \n , \n    cast(null as string) as \n    \n    budget_status\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        budget_association_status,\n        budget_name,\n        budget_status,\n        clicks,\n        impressions,\n        spend\n\n        \n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_daily_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.120822Z", "completed_at": "2024-07-09T21:39:12.548063Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.550449Z", "completed_at": "2024-07-09T21:39:12.550453Z"}], "thread_id": "Thread-4", "execution_time": 0.48500919342041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    start_date\n    \n as \n    \n    start_date\n    \n, \n    \n    \n    end_date\n    \n as \n    \n    end_date\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as ad_group_id,\n        name as ad_group_name,\n        campaign_id,\n        modified_time as modified_at,\n        start_date,\n        end_date,\n        status,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.124354Z", "completed_at": "2024-07-09T21:39:12.548826Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.551767Z", "completed_at": "2024-07-09T21:39:12.551771Z"}], "thread_id": "Thread-2", "execution_time": 0.4850461483001709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    title_part_1\n    \n as \n    \n    title_part_1\n    \n, \n    \n    \n    final_url\n    \n as \n    \n    final_url\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as ad_id,\n        title_part_1 as ad_name,\n        final_url,\n        ad_group_id,\n        modified_time as modified_at,\n        status,\n        type,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.132079Z", "completed_at": "2024-07-09T21:39:12.549459Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.552743Z", "completed_at": "2024-07-09T21:39:12.552747Z"}], "thread_id": "Thread-3", "execution_time": 0.43074798583984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    time_zone\n    \n as \n    \n    time_zone\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as campaign_id,\n        name as campaign_name,\n        account_id,\n        modified_time as modified_at,\n        type,\n        time_zone,\n        status,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.570944Z", "completed_at": "2024-07-09T21:39:12.581401Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.582131Z", "completed_at": "2024-07-09T21:39:12.582137Z"}], "thread_id": "Thread-3", "execution_time": 0.02483677864074707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__account_history_source_relation__account_id__modified_at.c32440cfcf", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, modified_at\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_history`\n    group by source_relation, account_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.584013Z", "completed_at": "2024-07-09T21:39:12.589883Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.590419Z", "completed_at": "2024-07-09T21:39:12.590423Z"}], "thread_id": "Thread-3", "execution_time": 0.00758814811706543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__account_history_account_id.cc273ee54e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_history`\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.592170Z", "completed_at": "2024-07-09T21:39:12.598766Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.599319Z", "completed_at": "2024-07-09T21:39:12.599322Z"}], "thread_id": "Thread-3", "execution_time": 0.008311033248901367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_group_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__device_os__device_type__network__language__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.3825c46fa1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_daily_report`\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.600987Z", "completed_at": "2024-07-09T21:39:12.604571Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.605229Z", "completed_at": "2024-07-09T21:39:12.605234Z"}], "thread_id": "Thread-3", "execution_time": 0.005321025848388672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_group_daily_report_ad_group_id.3e03e6eff7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_daily_report`\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.607156Z", "completed_at": "2024-07-09T21:39:12.614916Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.615536Z", "completed_at": "2024-07-09T21:39:12.615542Z"}], "thread_id": "Thread-3", "execution_time": 0.00957489013671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__account_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_daily_report`\n\n), \n\naccounts as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = True\n)\n\n, joined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        accounts.time_zone as account_timezone,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend\n\n        \n\n\n\n\n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9\n)\n\nselect *\nfrom joined", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__account_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.617601Z", "completed_at": "2024-07-09T21:39:12.621760Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.622372Z", "completed_at": "2024-07-09T21:39:12.622383Z"}], "thread_id": "Thread-3", "execution_time": 0.00605010986328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__account_daily_report_source_relation__date_day__account_id__device_os__device_type__network__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.38a7aa3e12", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_daily_report`\n    group by source_relation, date_day, account_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.624339Z", "completed_at": "2024-07-09T21:39:12.627824Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.628340Z", "completed_at": "2024-07-09T21:39:12.628345Z"}], "thread_id": "Thread-3", "execution_time": 0.005125999450683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__account_daily_report_account_id.b17f45fe79", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_daily_report`\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.630099Z", "completed_at": "2024-07-09T21:39:12.633595Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.634149Z", "completed_at": "2024-07-09T21:39:12.634153Z"}], "thread_id": "Thread-3", "execution_time": 0.0051860809326171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__device_os__device_type__network__language__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.b6f971641a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_daily_report`\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.635838Z", "completed_at": "2024-07-09T21:39:12.639726Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.640238Z", "completed_at": "2024-07-09T21:39:12.640242Z"}], "thread_id": "Thread-3", "execution_time": 0.00549006462097168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_daily_report_ad_id.1ed6689aa8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_daily_report`\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.642011Z", "completed_at": "2024-07-09T21:39:12.646300Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.646883Z", "completed_at": "2024-07-09T21:39:12.646887Z"}], "thread_id": "Thread-3", "execution_time": 0.006018161773681641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__campaign_daily_report_source_relation__date_day__account_id__campaign_id__device_os__device_type__network__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other__budget_association_status__budget_name__budget_status.f7a5fd8430", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other, budget_association_status, budget_name, budget_status\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_daily_report`\n    group by source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other, budget_association_status, budget_name, budget_status\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.648665Z", "completed_at": "2024-07-09T21:39:12.651817Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.652321Z", "completed_at": "2024-07-09T21:39:12.652325Z"}], "thread_id": "Thread-3", "execution_time": 0.004778146743774414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__campaign_daily_report_campaign_id.8ac0418e84", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_daily_report`\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.654153Z", "completed_at": "2024-07-09T21:39:12.657369Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.657899Z", "completed_at": "2024-07-09T21:39:12.657903Z"}], "thread_id": "Thread-3", "execution_time": 0.004911899566650391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_group_history_source_relation__ad_group_id__modified_at.f2ed2b82b0", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_group_id, modified_at\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_history`\n    group by source_relation, ad_group_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.659596Z", "completed_at": "2024-07-09T21:39:12.662884Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.663399Z", "completed_at": "2024-07-09T21:39:12.663403Z"}], "thread_id": "Thread-3", "execution_time": 0.004857063293457031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_group_history_ad_group_id.c8353342b7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_history`\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.665164Z", "completed_at": "2024-07-09T21:39:12.669009Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.669535Z", "completed_at": "2024-07-09T21:39:12.669539Z"}], "thread_id": "Thread-3", "execution_time": 0.0055696964263916016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_history_source_relation__ad_id__modified_at.2eb6255160", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_id, modified_at\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_history`\n    group by source_relation, ad_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.671213Z", "completed_at": "2024-07-09T21:39:12.674252Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.674752Z", "completed_at": "2024-07-09T21:39:12.674755Z"}], "thread_id": "Thread-3", "execution_time": 0.004623889923095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_history_ad_id.6d02c26574", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_history`\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.676416Z", "completed_at": "2024-07-09T21:39:12.681494Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.681996Z", "completed_at": "2024-07-09T21:39:12.682000Z"}], "thread_id": "Thread-3", "execution_time": 0.0066449642181396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__ad_group_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_daily_report`\n\n), \n\nad_groups as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_history`\n    where is_most_recent_record = True\n),\n\ncampaigns as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_history`\n    where is_most_recent_record = True\n),\n\naccounts as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = True\n),\n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend\n\n        \n\n\n\n\n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12\n)\n\nselect *\nfrom joined", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__ad_group_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.683674Z", "completed_at": "2024-07-09T21:39:12.689262Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.689744Z", "completed_at": "2024-07-09T21:39:12.689748Z"}], "thread_id": "Thread-3", "execution_time": 0.007128715515136719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__ad_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_daily_report`\n\n), \n\nads as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_history`\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_history`\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_history`\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        ads.type as ad_type,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend\n\n        \n\n\n\n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15\n\n)\n\nselect *\nfrom joined", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__ad_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.691390Z", "completed_at": "2024-07-09T21:39:12.696576Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.697082Z", "completed_at": "2024-07-09T21:39:12.697086Z"}], "thread_id": "Thread-3", "execution_time": 0.006762027740478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__campaign_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_daily_report`\n\n), \n\ncampaigns as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_history`\n    where is_most_recent_record = True\n),\n\naccounts as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = True\n),\n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        campaigns.type as campaign_type,\n        campaigns.time_zone as campaign_timezone,\n        campaigns.status as campaign_status,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend\n\n        \n\n\n\n\n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13\n)\n\nselect *\nfrom joined", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__campaign_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.698746Z", "completed_at": "2024-07-09T21:39:12.727809Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.728332Z", "completed_at": "2024-07-09T21:39:12.728337Z"}], "thread_id": "Thread-3", "execution_time": 0.030646085739135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__url_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_daily_report`\n\n), \n\nads as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_history`\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_history`\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_history`\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        \n\n  \n    split(\n        ads.final_url,\n        '?'\n        )[safe_offset(0)]\n  \n\n as base_url,\n        \n    safe_cast(\n\n  \n    split(\n        \n\n  \n    split(\n        \n\n    replace(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'android-app://',\n        ''\n    )\n\n\n,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/'\n        )[safe_offset(0)]\n  \n\n,\n        '?'\n        )[safe_offset(0)]\n  \n\n as string)\n as url_host,\n        '/' || \n    safe_cast(\n\n  \n    split(\n        \n\n    case when \n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/'\n\n    ), 0),\n            \n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '?'\n\n    ) - 1\n            ) = 0\n        then ''\n    else\n        substr(\n            \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n            -1 * (\n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/'\n\n    ), 0),\n            \n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '?'\n\n    ) - 1\n            ))\n        )\n    end,\n        '?'\n        )[safe_offset(0)]\n  \n\n as string)\n as url_path,\n\n        \n\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        ads.final_url,\n        'utm_source='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_source,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        ads.final_url,\n        'utm_medium='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_medium,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        ads.final_url,\n        'utm_campaign='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_campaign,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        ads.final_url,\n        'utm_content='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_content,\n        \n\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        ads.final_url,\n        'utm_term='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_term,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend\n\n        \n\n\n\n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22\n), \n\nfiltered as (\n\n    select * \n    from joined\n\n    \n        where base_url is not null\n    \n)\n\nselect *\nfrom filtered", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__url_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.730067Z", "completed_at": "2024-07-09T21:39:12.733325Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.733853Z", "completed_at": "2024-07-09T21:39:12.733857Z"}], "thread_id": "Thread-3", "execution_time": 0.005019187927246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__campaign_history_source_relation__campaign_id__modified_at.56da51b12d", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, modified_at\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_history`\n    group by source_relation, campaign_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.735561Z", "completed_at": "2024-07-09T21:39:12.738572Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.739066Z", "completed_at": "2024-07-09T21:39:12.739069Z"}], "thread_id": "Thread-3", "execution_time": 0.0045282840728759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__campaign_history_campaign_id.ee080a2122", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_history`\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.740691Z", "completed_at": "2024-07-09T21:39:12.744419Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.744948Z", "completed_at": "2024-07-09T21:39:12.744952Z"}], "thread_id": "Thread-3", "execution_time": 0.0053250789642333984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__account_report_source_relation__date_day__account_id__device_os__device_type__network__currency_code.42178a7c9b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, device_os, device_type, network, currency_code\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__account_report`\n    group by source_relation, date_day, account_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.746714Z", "completed_at": "2024-07-09T21:39:12.749608Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.750096Z", "completed_at": "2024-07-09T21:39:12.750100Z"}], "thread_id": "Thread-3", "execution_time": 0.004506826400756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__account_report_account_id.f88e46157e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__account_report`\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.751719Z", "completed_at": "2024-07-09T21:39:12.754737Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.755263Z", "completed_at": "2024-07-09T21:39:12.755266Z"}], "thread_id": "Thread-3", "execution_time": 0.004608869552612305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__ad_group_report_source_relation__date_day__account_id__campaign_id__ad_group_id__device_os__device_type__network__currency_code.da08ee00a5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, currency_code\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__ad_group_report`\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.756891Z", "completed_at": "2024-07-09T21:39:12.760073Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.760560Z", "completed_at": "2024-07-09T21:39:12.760563Z"}], "thread_id": "Thread-3", "execution_time": 0.004694938659667969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__ad_group_report_ad_group_id.1974ec5ab9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__ad_group_report`\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.762192Z", "completed_at": "2024-07-09T21:39:12.765538Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.766060Z", "completed_at": "2024-07-09T21:39:12.766063Z"}], "thread_id": "Thread-3", "execution_time": 0.004914045333862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__ad_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__ad_type__device_os__device_type__network__currency_code.e13fd60438", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, ad_type, device_os, device_type, network, currency_code\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__ad_report`\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, ad_type, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.767692Z", "completed_at": "2024-07-09T21:39:12.771361Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.771863Z", "completed_at": "2024-07-09T21:39:12.771867Z"}], "thread_id": "Thread-3", "execution_time": 0.005234956741333008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__ad_report_ad_id.b089709125", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__ad_report`\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.773519Z", "completed_at": "2024-07-09T21:39:12.776611Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.777141Z", "completed_at": "2024-07-09T21:39:12.777145Z"}], "thread_id": "Thread-3", "execution_time": 0.0047109127044677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__campaign_report_source_relation__date_day__account_id__campaign_id__device_os__device_type__network__currency_code.00fc594532", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__campaign_report`\n    group by source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.778793Z", "completed_at": "2024-07-09T21:39:12.781836Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.782324Z", "completed_at": "2024-07-09T21:39:12.782327Z"}], "thread_id": "Thread-3", "execution_time": 0.004555225372314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__campaign_report_campaign_id.67aa50e1f8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__campaign_report`\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.783943Z", "completed_at": "2024-07-09T21:39:12.787038Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.787570Z", "completed_at": "2024-07-09T21:39:12.787574Z"}], "thread_id": "Thread-3", "execution_time": 0.00467991828918457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__url_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__device_os__device_type__network__currency_code.0ea4732dff", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, currency_code\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__url_report`\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.789198Z", "completed_at": "2024-07-09T21:39:12.792940Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.793441Z", "completed_at": "2024-07-09T21:39:12.793444Z"}], "thread_id": "Thread-3", "execution_time": 0.005270957946777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__url_report_base_url.c1af50307a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_url\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__url_report`\nwhere base_url is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.562499Z", "completed_at": "2024-07-09T21:39:12.932128Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.932791Z", "completed_at": "2024-07-09T21:39:12.932797Z"}], "thread_id": "Thread-4", "execution_time": 0.3775007724761963, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__keyword_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    match_type\n    \n as \n    \n    match_type\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as keyword_id,\n        name as keyword_name,\n        modified_time as modified_at,\n        ad_group_id,\n        match_type,\n        status,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__keyword_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.558254Z", "completed_at": "2024-07-09T21:39:12.935422Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.941159Z", "completed_at": "2024-07-09T21:39:12.941164Z"}], "thread_id": "Thread-1", "execution_time": 0.39008212089538574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__keyword_daily_report_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    keyword_id\n    \n as \n    \n    keyword_id\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        keyword_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        clicks,\n        impressions,\n        spend\n\n        \n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__keyword_daily_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.936295Z", "completed_at": "2024-07-09T21:39:12.945711Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.946395Z", "completed_at": "2024-07-09T21:39:12.946399Z"}], "thread_id": "Thread-3", "execution_time": 0.012623786926269531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__keyword_history_source_relation__keyword_id__modified_at.5b0ba5f522", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, keyword_id, modified_at\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__keyword_history`\n    group by source_relation, keyword_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.941487Z", "completed_at": "2024-07-09T21:39:12.947887Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.949977Z", "completed_at": "2024-07-09T21:39:12.949981Z"}], "thread_id": "Thread-4", "execution_time": 0.025120019912719727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__keyword_history_keyword_id.19164a6209", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__keyword_history`\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.955667Z", "completed_at": "2024-07-09T21:39:12.962323Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.966428Z", "completed_at": "2024-07-09T21:39:12.966432Z"}], "thread_id": "Thread-3", "execution_time": 0.018786191940307617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__keyword_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__device_os__device_type__network__language__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.e55a075940", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__keyword_daily_report`\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.950259Z", "completed_at": "2024-07-09T21:39:12.965597Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.966749Z", "completed_at": "2024-07-09T21:39:12.966752Z"}], "thread_id": "Thread-1", "execution_time": 0.01980900764465332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__keyword_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__keyword_daily_report`\n\n), \n\nkeywords as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__keyword_history`\n    where is_most_recent_record = True\n),\n\nads as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_history`\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_history`\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_history`\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        keywords.keyword_name,\n        report.keyword_id,\n        keywords.match_type,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend\n\n        \n\n\n\n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join keywords\n        on report.keyword_id = keywords.keyword_id\n        and report.source_relation = keywords.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17\n)\n\nselect *\nfrom joined", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__keyword_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.962613Z", "completed_at": "2024-07-09T21:39:12.967012Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.968665Z", "completed_at": "2024-07-09T21:39:12.968668Z"}], "thread_id": "Thread-4", "execution_time": 0.007513999938964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__keyword_daily_report_keyword_id.e16b8c5047", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__keyword_daily_report`\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.974374Z", "completed_at": "2024-07-09T21:39:12.977277Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.978337Z", "completed_at": "2024-07-09T21:39:12.978341Z"}], "thread_id": "Thread-3", "execution_time": 0.00866079330444336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__keyword_report_keyword_id.da1d648d3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__keyword_report`\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.971285Z", "completed_at": "2024-07-09T21:39:12.977554Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.978594Z", "completed_at": "2024-07-09T21:39:12.978598Z"}], "thread_id": "Thread-4", "execution_time": 0.009582757949829102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__keyword_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__device_os__device_type__network__currency_code.e4af52a80b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, currency_code\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__keyword_report`\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.566577Z", "completed_at": "2024-07-09T21:39:12.992045Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:12.992545Z", "completed_at": "2024-07-09T21:39:12.992549Z"}], "thread_id": "Thread-2", "execution_time": 0.4359118938446045, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__search_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__search_daily_report_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    keyword_id\n    \n as \n    \n    keyword_id\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    search_query\n    \n as \n    \n    search_query\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n\n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        keyword_id,\n        search_query,\n        device_os,\n        device_type,\n        network,\n        language,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        clicks,\n        impressions,\n        spend\n\n        \n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__search_daily_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:12.994391Z", "completed_at": "2024-07-09T21:39:13.009460Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:13.009988Z", "completed_at": "2024-07-09T21:39:13.009993Z"}], "thread_id": "Thread-1", "execution_time": 0.016962051391601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__search_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__search_daily_report`\n\n), \n\nkeywords as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__keyword_history`\n    where is_most_recent_record = True\n),\n\nads as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_history`\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__ad_group_history`\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__campaign_history`\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__account_history`\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        report.keyword_id,\n        keywords.keyword_name,\n        coalesce(report.delivered_match_type, report.bid_match_type) as match_type,\n        report.search_query,\n        report.device_os,\n        report.device_type,\n        report.network,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend\n\n        \n\n\n\n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join keywords\n        on report.keyword_id = keywords.keyword_id\n        and report.source_relation = keywords.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17\n\n)\n\nselect *\nfrom joined", "relation_name": "`dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__search_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:13.002508Z", "completed_at": "2024-07-09T21:39:13.010245Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:13.011778Z", "completed_at": "2024-07-09T21:39:13.011782Z"}], "thread_id": "Thread-3", "execution_time": 0.012879133224487305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__search_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__search_query__device_os__device_type__network__language__bid_match_type__delivered_match_type__top_vs_other.97d894068e", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, language, bid_match_type, delivered_match_type, top_vs_other\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__search_daily_report`\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, language, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:13.006591Z", "completed_at": "2024-07-09T21:39:13.011385Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:13.014162Z", "completed_at": "2024-07-09T21:39:13.014166Z"}], "thread_id": "Thread-4", "execution_time": 0.009365081787109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__search_daily_report_search_query.57f687adcc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_query\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`stg_microsoft_ads__search_daily_report`\nwhere search_query is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:13.018950Z", "completed_at": "2024-07-09T21:39:13.022105Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:13.023249Z", "completed_at": "2024-07-09T21:39:13.023256Z"}], "thread_id": "Thread-1", "execution_time": 0.010265111923217773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__search_report_search_query.fa3625d66d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_query\nfrom `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__search_report`\nwhere search_query is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-09T21:39:13.015475Z", "completed_at": "2024-07-09T21:39:13.022419Z"}, {"name": "execute", "started_at": "2024-07-09T21:39:13.023528Z", "completed_at": "2024-07-09T21:39:13.023532Z"}], "thread_id": "Thread-2", "execution_time": 0.011219024658203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__search_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__search_query__device_os__device_type__network__match_type.6753357660", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, match_type\n    from `dbt-package-testing`.`microsoft_ads_source_microsoft_ads_dev`.`microsoft_ads__search_report`\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, match_type\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}], "elapsed_time": 2.6520612239837646, "args": {"favor_state": false, "introspect": true, "profiles_dir": "/Users/jamie.rodriguez/.dbt", "vars": {}, "select": [], "which": "generate", "quiet": false, "log_file_max_bytes": 10485760, "defer": false, "partial_parse_file_diff": true, "enable_legacy_logger": false, "log_level_file": "debug", "invocation_command": "dbt docs generate", "log_path": "/Users/jamie.rodriguez/Desktop/dbt_repos/Ads/Microsoft_ads/dbt_microsoft_ads/integration_tests/logs", "write_json": true, "static_parser": true, "print": true, "cache_selected_only": false, "warn_error_options": {"include": [], "exclude": []}, "populate_cache": true, "log_format_file": "debug", "compile": true, "strict_mode": false, "empty_catalog": false, "log_level": "info", "project_dir": "/Users/jamie.rodriguez/Desktop/dbt_repos/Ads/Microsoft_ads/dbt_microsoft_ads/integration_tests", "use_colors_file": true, "macro_debugging": false, "static": false, "partial_parse": true, "version_check": true, "use_colors": true, "exclude": [], "log_format": "default", "indirect_selection": "eager", "show_resource_report": false, "printer_width": 80, "send_anonymous_usage_stats": true}}