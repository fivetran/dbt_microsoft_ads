{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.18", "generated_at": "2024-08-20T07:31:09.276012Z", "invocation_id": "f2a612fb-e2bb-4e87-a723-5b358bf4081f", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.067923Z", "completed_at": "2024-08-20T07:31:06.093523Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.095510Z", "completed_at": "2024-08-20T07:31:06.095524Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06396007537841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_account_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.038662Z", "completed_at": "2024-08-20T07:31:06.093952Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.095998Z", "completed_at": "2024-08-20T07:31:06.096001Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0653071403503418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_account_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.089936Z", "completed_at": "2024-08-20T07:31:06.094283Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.096276Z", "completed_at": "2024-08-20T07:31:06.096279Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06352114677429199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_ad_group_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.086797Z", "completed_at": "2024-08-20T07:31:06.094813Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.097167Z", "completed_at": "2024-08-20T07:31:06.097175Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06592226028442383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_ad_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.102294Z", "completed_at": "2024-08-20T07:31:06.114472Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.115027Z", "completed_at": "2024-08-20T07:31:06.115034Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015420198440551758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_ad_group_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.105528Z", "completed_at": "2024-08-20T07:31:06.116704Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.121507Z", "completed_at": "2024-08-20T07:31:06.121514Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022426843643188477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_ad_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.111511Z", "completed_at": "2024-08-20T07:31:06.117001Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.121873Z", "completed_at": "2024-08-20T07:31:06.121881Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022112131118774414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_campaign_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.108839Z", "completed_at": "2024-08-20T07:31:06.117237Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.122215Z", "completed_at": "2024-08-20T07:31:06.122219Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.023206233978271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_campaign_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.117484Z", "completed_at": "2024-08-20T07:31:06.122515Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.125966Z", "completed_at": "2024-08-20T07:31:06.125971Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011584997177124023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_keyword_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.134985Z", "completed_at": "2024-08-20T07:31:06.136138Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.137607Z", "completed_at": "2024-08-20T07:31:06.137614Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012762069702148438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_account_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.137884Z", "completed_at": "2024-08-20T07:31:06.138850Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.141055Z", "completed_at": "2024-08-20T07:31:06.141059Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00599217414855957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_account_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.128810Z", "completed_at": "2024-08-20T07:31:06.139124Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.141300Z", "completed_at": "2024-08-20T07:31:06.141303Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016895055770874023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_keyword_history_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.131625Z", "completed_at": "2024-08-20T07:31:06.139353Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.141538Z", "completed_at": "2024-08-20T07:31:06.141540Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01697683334350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__search_daily_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5\".\"microsoft_ads_search_performance_daily_report_data\"", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__search_daily_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.145293Z", "completed_at": "2024-08-20T07:31:06.146495Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.148701Z", "completed_at": "2024-08-20T07:31:06.148706Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01156306266784668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_group_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.149001Z", "completed_at": "2024-08-20T07:31:06.150019Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.154500Z", "completed_at": "2024-08-20T07:31:06.154503Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008853912353515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_group_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.150308Z", "completed_at": "2024-08-20T07:31:06.151154Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.154750Z", "completed_at": "2024-08-20T07:31:06.154753Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008836984634399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.151393Z", "completed_at": "2024-08-20T07:31:06.152986Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.154962Z", "completed_at": "2024-08-20T07:31:06.154965Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008868932723999023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_ad_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.157719Z", "completed_at": "2024-08-20T07:31:06.158922Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.161321Z", "completed_at": "2024-08-20T07:31:06.161327Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010652780532836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.161617Z", "completed_at": "2024-08-20T07:31:06.162622Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.166907Z", "completed_at": "2024-08-20T07:31:06.166910Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008744955062866211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_campaign_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.162898Z", "completed_at": "2024-08-20T07:31:06.163915Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.167153Z", "completed_at": "2024-08-20T07:31:06.167155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008738040924072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_keyword_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.164220Z", "completed_at": "2024-08-20T07:31:06.165302Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.167368Z", "completed_at": "2024-08-20T07:31:06.167370Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008736133575439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_keyword_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.170393Z", "completed_at": "2024-08-20T07:31:06.171506Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:06.173662Z", "completed_at": "2024-08-20T07:31:06.173669Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0255889892578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.microsoft_ads_integration_tests.microsoft_ads_search_performance_daily_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.185721Z", "completed_at": "2024-08-20T07:31:07.067237Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:07.068613Z", "completed_at": "2024-08-20T07:31:07.068616Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.981848955154419, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n, \n    \n    \n    conversions_qualified\n    \n as \n    \n    conversions_qualified\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    revenue\n    \n as \n    \n    revenue\n    \n, \n    \n    \n    all_conversions\n    \n as \n    \n    all_conversions\n    \n, \n    \n    \n    all_conversions_qualified\n    \n as \n    \n    all_conversions_qualified\n    \n, \n    \n    \n    all_revenue\n    \n as \n    \n    all_revenue\n    \n\n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(conversions_qualified, conversions), 0) as conversions,\n        coalesce(revenue, 0) as conversions_value,\n        coalesce(coalesce(all_conversions_qualified, all_conversions), 0) as all_conversions,\n        coalesce(all_revenue, 0) as all_conversions_value\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.173914Z", "completed_at": "2024-08-20T07:31:07.066431Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:07.067476Z", "completed_at": "2024-08-20T07:31:07.067481Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.9843230247497559, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    last_modified_time\n    \n as \n    \n    last_modified_time\n    \n, \n    \n    \n    time_zone\n    \n as \n    \n    time_zone\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as account_id,\n        name as account_name,\n        last_modified_time as modified_at,\n        time_zone,\n        currency_code,\n        row_number() over (partition by source_relation, id order by last_modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.196142Z", "completed_at": "2024-08-20T07:31:07.066949Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:07.068388Z", "completed_at": "2024-08-20T07:31:07.068392Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.9613330364227295, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n, \n    \n    \n    conversions_qualified\n    \n as \n    \n    conversions_qualified\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    revenue\n    \n as \n    \n    revenue\n    \n, \n    \n    \n    all_conversions\n    \n as \n    \n    all_conversions\n    \n, \n    \n    \n    all_conversions_qualified\n    \n as \n    \n    all_conversions_qualified\n    \n, \n    \n    \n    all_revenue\n    \n as \n    \n    all_revenue\n    \n\n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(conversions_qualified, conversions), 0) as conversions,\n        coalesce(revenue, 0) as conversions_value,\n        coalesce(coalesce(all_conversions_qualified, all_conversions), 0) as all_conversions,\n        coalesce(all_revenue, 0) as all_conversions_value\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:06.180401Z", "completed_at": "2024-08-20T07:31:07.065228Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:07.065907Z", "completed_at": "2024-08-20T07:31:07.065915Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9852540493011475, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__account_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n, \n    \n    \n    conversions_qualified\n    \n as \n    \n    conversions_qualified\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    revenue\n    \n as \n    \n    revenue\n    \n, \n    cast(null as integer) as \n    \n    all_conversions\n    \n , \n    \n    \n    all_conversions_qualified\n    \n as \n    \n    all_conversions_qualified\n    \n, \n    cast(null as numeric(28,6)) as \n    \n    all_revenue\n    \n \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        device_os,\n        device_type,\n        network,\n        currency_code, \n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(conversions_qualified, conversions), 0) as conversions,\n        coalesce(revenue, 0) as conversions_value,\n        all_conversions_qualified as all_conversions   \n\n        \n\n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:07.214079Z", "completed_at": "2024-08-20T07:31:08.085702Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.086975Z", "completed_at": "2024-08-20T07:31:08.086990Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.012300968170166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n, \n    \n    \n    budget_association_status\n    \n as \n    \n    budget_association_status\n    \n, \n    \n    \n    budget_name\n    \n as \n    \n    budget_name\n    \n, \n    cast(null as TEXT) as \n    \n    budget_status\n    \n , \n    \n    \n    conversions_qualified\n    \n as \n    \n    conversions_qualified\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    revenue\n    \n as \n    \n    revenue\n    \n, \n    \n    \n    all_conversions\n    \n as \n    \n    all_conversions\n    \n, \n    \n    \n    all_conversions_qualified\n    \n as \n    \n    all_conversions_qualified\n    \n, \n    \n    \n    all_revenue\n    \n as \n    \n    all_revenue\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        budget_association_status,\n        budget_name,\n        budget_status,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(conversions_qualified, conversions), 0) as conversions,\n        coalesce(revenue, 0) as conversions_value,\n        coalesce(coalesce(all_conversions_qualified, all_conversions), 0) as all_conversions,\n        coalesce(all_revenue, 0) as all_conversions_value\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:07.209368Z", "completed_at": "2024-08-20T07:31:08.086098Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.087236Z", "completed_at": "2024-08-20T07:31:08.087240Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.017961025238037, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    time_zone\n    \n as \n    \n    time_zone\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as campaign_id,\n        name as campaign_name,\n        account_id,\n        modified_time as modified_at,\n        type,\n        time_zone,\n        status,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:07.166382Z", "completed_at": "2024-08-20T07:31:08.107193Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.107815Z", "completed_at": "2024-08-20T07:31:08.107822Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0333070755004883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    title_part_1\n    \n as \n    \n    title_part_1\n    \n, \n    \n    \n    final_url\n    \n as \n    \n    final_url\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as ad_id,\n        title_part_1 as ad_name,\n        final_url,\n        ad_group_id,\n        modified_time as modified_at,\n        status,\n        type,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:07.159937Z", "completed_at": "2024-08-20T07:31:08.139112Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.139855Z", "completed_at": "2024-08-20T07:31:08.139864Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0684280395507812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__ad_group_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    start_date\n    \n as \n    \n    start_date\n    \n, \n    \n    \n    end_date\n    \n as \n    \n    end_date\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as ad_group_id,\n        name as ad_group_name,\n        campaign_id,\n        modified_time as modified_at,\n        start_date,\n        end_date,\n        status,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.227035Z", "completed_at": "2024-08-20T07:31:08.239899Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.240552Z", "completed_at": "2024-08-20T07:31:08.240559Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.014909982681274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_group_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__device_os__device_type__network__language__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.3825c46fa1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.242443Z", "completed_at": "2024-08-20T07:31:08.249385Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.249915Z", "completed_at": "2024-08-20T07:31:08.249920Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008594989776611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_group_daily_report_ad_group_id.3e03e6eff7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_daily_report\"\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.251575Z", "completed_at": "2024-08-20T07:31:08.255271Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.255963Z", "completed_at": "2024-08-20T07:31:08.255971Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005563020706176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__account_history_source_relation__account_id__modified_at.c32440cfcf", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    group by source_relation, account_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.257931Z", "completed_at": "2024-08-20T07:31:08.261786Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.262314Z", "completed_at": "2024-08-20T07:31:08.262322Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0055370330810546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__account_history_account_id.cc273ee54e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.263951Z", "completed_at": "2024-08-20T07:31:08.267156Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.267650Z", "completed_at": "2024-08-20T07:31:08.267654Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0046999454498291016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__device_os__device_type__network__language__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.b6f971641a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.269155Z", "completed_at": "2024-08-20T07:31:08.271988Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.272516Z", "completed_at": "2024-08-20T07:31:08.272521Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004322052001953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_daily_report_ad_id.1ed6689aa8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_daily_report\"\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.274104Z", "completed_at": "2024-08-20T07:31:08.283578Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.284205Z", "completed_at": "2024-08-20T07:31:08.284212Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011137008666992188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__account_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_daily_report\"\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n)\n\n, joined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        accounts.time_zone as account_timezone,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value\n\n        \n\n\n\n    \n    \n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__account_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.285755Z", "completed_at": "2024-08-20T07:31:08.288826Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.289466Z", "completed_at": "2024-08-20T07:31:08.289471Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004707813262939453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__account_daily_report_source_relation__date_day__account_id__device_os__device_type__network__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.38a7aa3e12", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_daily_report\"\n    group by source_relation, date_day, account_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.291066Z", "completed_at": "2024-08-20T07:31:08.294244Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.294713Z", "completed_at": "2024-08-20T07:31:08.294719Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004740238189697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__account_daily_report_account_id.b17f45fe79", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_daily_report\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.296721Z", "completed_at": "2024-08-20T07:31:08.300342Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.300840Z", "completed_at": "2024-08-20T07:31:08.300846Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005216121673583984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__campaign_daily_report_source_relation__date_day__account_id__campaign_id__device_os__device_type__network__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other__budget_association_status__budget_name__budget_status.f7a5fd8430", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other, budget_association_status, budget_name, budget_status\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other, budget_association_status, budget_name, budget_status\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.302695Z", "completed_at": "2024-08-20T07:31:08.305783Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.306281Z", "completed_at": "2024-08-20T07:31:08.306288Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004857301712036133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__campaign_daily_report_campaign_id.8ac0418e84", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_daily_report\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.307940Z", "completed_at": "2024-08-20T07:31:08.313355Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.313769Z", "completed_at": "2024-08-20T07:31:08.313773Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0068018436431884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__campaign_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_daily_report\"\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n),\n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n),\n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        campaigns.type as campaign_type,\n        campaigns.time_zone as campaign_timezone,\n        campaigns.status as campaign_status,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value\n\n        \n\n\n\n \n\n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__campaign_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.315460Z", "completed_at": "2024-08-20T07:31:08.318551Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.319049Z", "completed_at": "2024-08-20T07:31:08.319056Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004705905914306641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__campaign_history_source_relation__campaign_id__modified_at.56da51b12d", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\n    group by source_relation, campaign_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.320622Z", "completed_at": "2024-08-20T07:31:08.323397Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.323816Z", "completed_at": "2024-08-20T07:31:08.323820Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004127979278564453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__campaign_history_campaign_id.ee080a2122", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.325448Z", "completed_at": "2024-08-20T07:31:08.328678Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.329189Z", "completed_at": "2024-08-20T07:31:08.329195Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004853010177612305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_history_source_relation__ad_id__modified_at.2eb6255160", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history\"\n    group by source_relation, ad_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.330880Z", "completed_at": "2024-08-20T07:31:08.333631Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.334058Z", "completed_at": "2024-08-20T07:31:08.334062Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004172801971435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_history_ad_id.6d02c26574", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history\"\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.335585Z", "completed_at": "2024-08-20T07:31:08.340943Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.341391Z", "completed_at": "2024-08-20T07:31:08.341396Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0067861080169677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__ad_group_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_daily_report\"\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n),\n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n),\n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n),\n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value\n\n        \n\n\n\n    \n    from report\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__ad_group_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.343214Z", "completed_at": "2024-08-20T07:31:08.348952Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.349438Z", "completed_at": "2024-08-20T07:31:08.349444Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0073931217193603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__ad_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_daily_report\"\n\n), \n\nads as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history\"\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        ads.type as ad_type,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value\n\n        \n\n\n\n    \n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15\n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__ad_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.351074Z", "completed_at": "2024-08-20T07:31:08.380110Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.380612Z", "completed_at": "2024-08-20T07:31:08.380619Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03052806854248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__url_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_daily_report\"\n\n), \n\nads as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history\"\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        '?',\n        1\n        )\n\n\n  \n\n as base_url,\n        \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        \n\n    replace(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'android-app://',\n        ''\n    )\n\n\n,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/',\n        1\n        )\n\n\n  \n\n,\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_host,\n        '/' || \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n    right(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        \n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    position(\n        '/' in \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ), 0),\n            \n\n    position(\n        '?' in \n\n    replace(\n        \n\n    replace(\n        ads.final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ) - 1\n            )\n    ),\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_path,\n\n        \n\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_source=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_source,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_medium=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_medium,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_campaign=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_campaign,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_content=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_content,\n        \n\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        ads.final_url,\n        'utm_term=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_term,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value\n\n        \n\n\n\n\n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22\n), \n\nfiltered as (\n\n    select * \n    from joined\n\n    \n        where base_url is not null\n    \n)\n\nselect *\nfrom filtered", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__url_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.382458Z", "completed_at": "2024-08-20T07:31:08.385726Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.386232Z", "completed_at": "2024-08-20T07:31:08.386238Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004976034164428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__ad_group_history_source_relation__ad_group_id__modified_at.f2ed2b82b0", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_group_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\"\n    group by source_relation, ad_group_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.387908Z", "completed_at": "2024-08-20T07:31:08.391644Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.392112Z", "completed_at": "2024-08-20T07:31:08.392117Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0051708221435546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__ad_group_history_ad_group_id.c8353342b7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\"\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.393593Z", "completed_at": "2024-08-20T07:31:08.396602Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.397037Z", "completed_at": "2024-08-20T07:31:08.397041Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004461050033569336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__account_report_source_relation__date_day__account_id__device_os__device_type__network__currency_code.42178a7c9b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__account_report\"\n    group by source_relation, date_day, account_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.398907Z", "completed_at": "2024-08-20T07:31:08.401875Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.402320Z", "completed_at": "2024-08-20T07:31:08.402328Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004591226577758789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__account_report_account_id.f88e46157e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__account_report\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.404164Z", "completed_at": "2024-08-20T07:31:08.407459Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.407993Z", "completed_at": "2024-08-20T07:31:08.407999Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005049228668212891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__campaign_report_source_relation__date_day__account_id__campaign_id__device_os__device_type__network__currency_code.00fc594532", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__campaign_report\"\n    group by source_relation, date_day, account_id, campaign_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.409530Z", "completed_at": "2024-08-20T07:31:08.412538Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.412995Z", "completed_at": "2024-08-20T07:31:08.413000Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004402875900268555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__campaign_report_campaign_id.67aa50e1f8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__campaign_report\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.414614Z", "completed_at": "2024-08-20T07:31:08.418199Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.418644Z", "completed_at": "2024-08-20T07:31:08.418649Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00497889518737793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__ad_group_report_source_relation__date_day__account_id__campaign_id__ad_group_id__device_os__device_type__network__currency_code.da08ee00a5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__ad_group_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.420295Z", "completed_at": "2024-08-20T07:31:08.423051Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.423457Z", "completed_at": "2024-08-20T07:31:08.423461Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004229307174682617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__ad_group_report_ad_group_id.1974ec5ab9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__ad_group_report\"\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.425250Z", "completed_at": "2024-08-20T07:31:08.428512Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.428964Z", "completed_at": "2024-08-20T07:31:08.428968Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004900693893432617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__ad_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__ad_type__device_os__device_type__network__currency_code.e13fd60438", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, ad_type, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__ad_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, ad_type, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.430397Z", "completed_at": "2024-08-20T07:31:08.433050Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.433456Z", "completed_at": "2024-08-20T07:31:08.433459Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.003916025161743164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__ad_report_ad_id.b089709125", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__ad_report\"\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.435201Z", "completed_at": "2024-08-20T07:31:08.438287Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.438719Z", "completed_at": "2024-08-20T07:31:08.438724Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0047109127044677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__url_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__device_os__device_type__network__currency_code.0ea4732dff", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__url_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.440412Z", "completed_at": "2024-08-20T07:31:08.444368Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:08.444801Z", "completed_at": "2024-08-20T07:31:08.444805Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0055048465728759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__url_report_base_url.c1af50307a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_url\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__url_report\"\nwhere base_url is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.179862Z", "completed_at": "2024-08-20T07:31:09.038663Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.039278Z", "completed_at": "2024-08-20T07:31:09.039284Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9530651569366455, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_distribution\n    \n as \n    \n    ad_distribution\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    keyword_id\n    \n as \n    \n    keyword_id\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n, \n    \n    \n    conversions_qualified\n    \n as \n    \n    conversions_qualified\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    revenue\n    \n as \n    \n    revenue\n    \n, \n    \n    \n    all_conversions\n    \n as \n    \n    all_conversions\n    \n, \n    \n    \n    all_conversions_qualified\n    \n as \n    \n    all_conversions_qualified\n    \n, \n    \n    \n    all_revenue\n    \n as \n    \n    all_revenue\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        keyword_id,\n        currency_code,\n        device_os,\n        device_type,\n        network,\n        language,\n        ad_distribution,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(conversions_qualified, conversions), 0) as conversions,\n        coalesce(revenue, 0) as conversions_value,\n        coalesce(coalesce(all_conversions_qualified, all_conversions), 0) as all_conversions,\n        coalesce(all_revenue, 0) as all_conversions_value\n\n        \n\n\n\n\n    \n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.184777Z", "completed_at": "2024-08-20T07:31:09.036882Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.037779Z", "completed_at": "2024-08-20T07:31:09.037788Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.9536490440368652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__keyword_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    modified_time\n    \n as \n    \n    modified_time\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    match_type\n    \n as \n    \n    match_type\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as keyword_id,\n        name as keyword_name,\n        modified_time as modified_at,\n        ad_group_id,\n        match_type,\n        status,\n        row_number() over (partition by source_relation, id order by modified_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:09.135573Z", "completed_at": "2024-08-20T07:31:09.145621Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.153001Z", "completed_at": "2024-08-20T07:31:09.153007Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02231287956237793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__keyword_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__device_os__device_type__network__language__currency_code__ad_distribution__bid_match_type__delivered_match_type__top_vs_other.e55a075940", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, language, currency_code, ad_distribution, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:09.140923Z", "completed_at": "2024-08-20T07:31:09.152136Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.154944Z", "completed_at": "2024-08-20T07:31:09.154952Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021603107452392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__keyword_daily_report_keyword_id.e16b8c5047", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_daily_report\"\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:09.145950Z", "completed_at": "2024-08-20T07:31:09.154426Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.156903Z", "completed_at": "2024-08-20T07:31:09.156906Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017849206924438477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__keyword_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_daily_report\"\n\n), \n\nkeywords as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_history\"\n    where is_most_recent_record = True\n),\n\nads as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history\"\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        keywords.keyword_name,\n        report.keyword_id,\n        keywords.match_type,\n        report.device_os,\n        report.device_type,\n        report.network,\n        report.currency_code,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value\n\n        \n\n\n\n\n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join keywords\n        on report.keyword_id = keywords.keyword_id\n        and report.source_relation = keywords.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__keyword_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:09.159630Z", "completed_at": "2024-08-20T07:31:09.170191Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.172031Z", "completed_at": "2024-08-20T07:31:09.172039Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01568293571472168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__keyword_history_source_relation__keyword_id__modified_at.5b0ba5f522", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, keyword_id, modified_at\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_history\"\n    group by source_relation, keyword_id, modified_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:09.163740Z", "completed_at": "2024-08-20T07:31:09.170699Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.172308Z", "completed_at": "2024-08-20T07:31:09.172311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01535797119140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__keyword_history_keyword_id.19164a6209", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_history\"\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:09.167161Z", "completed_at": "2024-08-20T07:31:09.171717Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.173961Z", "completed_at": "2024-08-20T07:31:09.173970Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011534929275512695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__keyword_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__device_os__device_type__network__currency_code.e4af52a80b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, currency_code\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__keyword_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, device_os, device_type, network, currency_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:09.175906Z", "completed_at": "2024-08-20T07:31:09.180409Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.180837Z", "completed_at": "2024-08-20T07:31:09.180842Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006089925765991211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__keyword_report_keyword_id.da1d648d3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__keyword_report\"\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:08.193970Z", "completed_at": "2024-08-20T07:31:09.135302Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.145159Z", "completed_at": "2024-08-20T07:31:09.145171Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0455272197723389, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads_source.stg_microsoft_ads__search_daily_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__search_daily_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    bid_match_type\n    \n as \n    \n    bid_match_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    delivered_match_type\n    \n as \n    \n    delivered_match_type\n    \n, \n    \n    \n    device_os\n    \n as \n    \n    device_os\n    \n, \n    \n    \n    device_type\n    \n as \n    \n    device_type\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    keyword_id\n    \n as \n    \n    keyword_id\n    \n, \n    \n    \n    language\n    \n as \n    \n    language\n    \n, \n    \n    \n    network\n    \n as \n    \n    network\n    \n, \n    \n    \n    search_query\n    \n as \n    \n    search_query\n    \n, \n    \n    \n    spend\n    \n as \n    \n    spend\n    \n, \n    \n    \n    top_vs_other\n    \n as \n    \n    top_vs_other\n    \n, \n    \n    \n    conversions_qualified\n    \n as \n    \n    conversions_qualified\n    \n, \n    \n    \n    conversions\n    \n as \n    \n    conversions\n    \n, \n    \n    \n    revenue\n    \n as \n    \n    revenue\n    \n, \n    \n    \n    all_conversions\n    \n as \n    \n    all_conversions\n    \n, \n    \n    \n    all_conversions_qualified\n    \n as \n    \n    all_conversions_qualified\n    \n, \n    \n    \n    all_revenue\n    \n as \n    \n    all_revenue\n    \n\n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date as date_day,\n        account_id,\n        campaign_id,\n        ad_group_id,\n        ad_id,\n        keyword_id,\n        search_query,\n        device_os,\n        device_type,\n        network,\n        language,\n        bid_match_type,\n        delivered_match_type,\n        top_vs_other,\n        coalesce(clicks, 0) as clicks, \n        coalesce(impressions, 0) as impressions,\n        coalesce(spend, 0) as spend,\n        coalesce(coalesce(conversions_qualified, conversions), 0) as conversions,\n        coalesce(revenue, 0) as conversions_value,\n        coalesce(coalesce(all_conversions_qualified, all_conversions), 0) as all_conversions,\n        coalesce(all_revenue, 0) as all_conversions_value\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__search_daily_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:09.240718Z", "completed_at": "2024-08-20T07:31:09.257225Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.258141Z", "completed_at": "2024-08-20T07:31:09.258150Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018687963485717773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.microsoft_ads.microsoft_ads__search_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__search_daily_report\"\n\n), \n\nkeywords as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__keyword_history\"\n    where is_most_recent_record = True\n),\n\nads as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_history\"\n    where is_most_recent_record = True\n\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__ad_group_history\"\n    where is_most_recent_record = True\n\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__campaign_history\"\n    where is_most_recent_record = True\n\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__account_history\"\n    where is_most_recent_record = True\n\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        accounts.account_name,\n        report.account_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ads.ad_name,\n        report.ad_id,\n        report.keyword_id,\n        keywords.keyword_name,\n        coalesce(report.delivered_match_type, report.bid_match_type) as match_type,\n        report.search_query,\n        report.device_os,\n        report.device_type,\n        report.network,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.spend) as spend,\n        sum(report.conversions) as conversions,\n        sum(report.conversions_value) as conversions_value\n\n        \n\n\n\n\n\n    from report\n    left join ads\n        on report.ad_id = ads.ad_id\n        and report.source_relation = ads.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join accounts\n        on report.account_id = accounts.account_id\n        and report.source_relation = accounts.source_relation\n    left join keywords\n        on report.keyword_id = keywords.keyword_id\n        and report.source_relation = keywords.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17\n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__search_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:09.254451Z", "completed_at": "2024-08-20T07:31:09.259110Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.261523Z", "completed_at": "2024-08-20T07:31:09.261528Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.014729976654052734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.not_null_stg_microsoft_ads__search_daily_report_search_query.57f687adcc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_query\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__search_daily_report\"\nwhere search_query is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:09.249338Z", "completed_at": "2024-08-20T07:31:09.259396Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.261795Z", "completed_at": "2024-08-20T07:31:09.261799Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015747785568237305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads_source.dbt_utils_unique_combination_of_columns_stg_microsoft_ads__search_daily_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__search_query__device_os__device_type__network__language__bid_match_type__delivered_match_type__top_vs_other.97d894068e", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, language, bid_match_type, delivered_match_type, top_vs_other\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"stg_microsoft_ads__search_daily_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, language, bid_match_type, delivered_match_type, top_vs_other\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:09.264082Z", "completed_at": "2024-08-20T07:31:09.271969Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.273042Z", "completed_at": "2024-08-20T07:31:09.273049Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013052940368652344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.dbt_utils_unique_combination_of_columns_microsoft_ads__search_report_source_relation__date_day__account_id__campaign_id__ad_group_id__ad_id__keyword_id__search_query__device_os__device_type__network__match_type.6753357660", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, match_type\n    from \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__search_report\"\n    group by source_relation, date_day, account_id, campaign_id, ad_group_id, ad_id, keyword_id, search_query, device_os, device_type, network, match_type\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-20T07:31:09.267700Z", "completed_at": "2024-08-20T07:31:09.272317Z"}, {"name": "execute", "started_at": "2024-08-20T07:31:09.273306Z", "completed_at": "2024-08-20T07:31:09.273309Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01318669319152832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.microsoft_ads.not_null_microsoft_ads__search_report_search_query.fa3625d66d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_query\nfrom \"postgres\".\"microsoft_ads_integration_tests_5_microsoft_ads_dev\".\"microsoft_ads__search_report\"\nwhere search_query is null\n\n\n", "relation_name": null}], "elapsed_time": 5.915477991104126, "args": {"project_dir": "/Users/avinash.kunnath/Documents/dbt_packages/microsoft_ads/dbt_microsoft_ads/integration_tests", "select": [], "quiet": false, "strict_mode": false, "macro_debugging": false, "indirect_selection": "eager", "write_json": true, "static_parser": true, "which": "generate", "enable_legacy_logger": false, "log_format": "default", "defer": false, "log_path": "/Users/avinash.kunnath/Documents/dbt_packages/microsoft_ads/dbt_microsoft_ads/integration_tests/logs", "static": false, "populate_cache": true, "use_colors_file": true, "printer_width": 80, "introspect": true, "target": "postgres", "partial_parse_file_diff": true, "version_check": true, "empty_catalog": false, "invocation_command": "dbt docs generate -t postgres", "log_format_file": "debug", "send_anonymous_usage_stats": true, "warn_error_options": {"include": [], "exclude": []}, "favor_state": false, "show_resource_report": false, "print": true, "vars": {}, "partial_parse": true, "exclude": [], "require_explicit_package_overrides_for_builtin_materializations": false, "log_file_max_bytes": 10485760, "log_level": "info", "use_colors": true, "profiles_dir": "/Users/avinash.kunnath/.dbt", "compile": true, "cache_selected_only": false, "log_level_file": "debug"}}